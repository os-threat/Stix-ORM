{
  "type": "bundle",
  "id": "bundle--c362c559-69b5-4001-a1b0-745e8412d191",
  "objects": [
    {
      "id": "tool--a1e3e09a-26c1-439c-8985-5bdf2ed377fa",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Net user",
      "tool_types": [
        "remote-access",
        "exploitation"
      ]
    },
    {
      "id": "tool--09b75cde-799f-432c-9920-bbf13d0eb336",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Netstat",
      "tool_types": [
        "Information-gathering"
      ]
    },
    {
      "id": "tool--e378563e-c6df-4d01-89a9-f3545cc42517",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Windows Management Instrumentation (WMI)",
      "tool_types": [
        "Information-gathering"
      ]
    },
    {
      "id": "tool--b1ddb6da-5c43-440d-9189-39c740659ccc",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Netsh",
      "tool_types": [
        "Information-gathering"
      ]
    },
    {
      "id": "attack-asset--1eccea60-8db3-4ac0-9db2-d4eef1c3b484",
      "type": "attack-asset",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Windows Admin Shares"
    },
    {
      "id": "attack-operator--65620718-41a3-43e9-842a-e169a076170a",
      "type": "attack-operator",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "operator": "AND"
    },
    {
      "id": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "type": "identity",
      "modified": "2025-03-19T15:00:40.855Z",
      "name": "The MITRE Corporation",
      "description": "",
      "identity_class": "organization",
      "spec_version": "2.1",
      "created": "2017-06-01T00:00:00.000Z",
      "x_mitre_attack_spec_version": "3.2.0"
    },
    {
      "id": "tool--750c2016-1016-48d8-95ea-df5b32a8f8ee",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Mimikatz",
      "tool_types": [
        "credential-exploitation"
      ]
    },
    {
      "id": "identity--f02f372c-5f8f-49a0-be8e-778cc6f53cc8",
      "type": "identity",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.726Z",
      "modified": "2025-07-30T19:47:12.726Z",
      "name": "Eric Kannampuzha",
      "contact_information": "ekannampuzha@mitre.org"
    },
    {
      "id": "tool--127e715e-a04a-4103-84ef-99015b27d94f",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Ipconfig",
      "tool_types": [
        "Information-gathering"
      ]
    },
    {
      "id": "campaign--8ed0c3ff-cecd-40f1-9d6b-e3dbe955ac7a",
      "type": "campaign",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Operation Cobalt Kitty",
      "description": "A large-scale campaign in Asia carried out by the OceanLotus Group",
      "objective": "Stealing proprietary business information"
    },
    {
      "id": "identity--fb9c968a-745b-4ade-9b25-c324172197f4",
      "type": "identity",
      "spec_version": "2.1",
      "created": "2022-08-02T19:34:35.143Z",
      "modified": "2022-08-02T19:34:35.143Z",
      "name": "MITRE Center for Threat-Informed Defense",
      "identity_class": "organization"
    },
    {
      "id": "tool--38394be6-1da8-45e2-86c4-180837bd00e8",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Arp",
      "tool_types": [
        "Information-gathering"
      ]
    },
    {
      "id": "tool--f2fac0de-8565-48ab-9ce8-d67dee1edeb6",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Mimikatz",
      "tool_types": [
        "credential-exploitation"
      ]
    },
    {
      "id": "threat-actor--f5182f82-449b-4edd-9c74-bf2ad4bcaf9d",
      "type": "threat-actor",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "OceanLotus",
      "description": "APT32 is a suspected Vietnam-based threat group that has been active since at least 2012. The group has targeted multiple private sector industries as well as foreign governments, dissidents, and journalists with a strong focus on Southeast Asian countries like Vietnam, the Philippines, Laos, and Cambodia. Their primary objective is to collect information related to perceived threats to the Vietnamese government, but with possible geopolitical and economic espionage objectives as well. They have extensively used strategic web compromises to compromise victims.",
      "threat_actor_types": [
        "Activist",
        "Crime-syndicate",
        "Competitor"
      ],
      "aliases": [
        "Ocean Buffalo",
        "SeaLotus",
        "APT32",
        "TIN WOODLAWN",
        "APT-C-00"
      ],
      "first_seen": "2012-01-01T00:00:00.000Z",
      "roles": [
        "Agent",
        "Independent"
      ],
      "goals": [
        "Collect information on perceived threats to the Vietnamese government; geopolitical and economic espionage"
      ],
      "sophistication": "Expert",
      "resource_level": "Organization",
      "primary_motivation": "organizational-gain",
      "secondary_motivations": [
        "ideology"
      ]
    },
    {
      "id": "tool--0ade6c1a-d0b5-47d2-a633-b61144024874",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Nslookup",
      "tool_types": [
        "Information-gathering"
      ]
    },
    {
      "id": "tool--1d4a5369-38f8-4b40-8390-2c3cf8f940a0",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "WMI",
      "tool_types": [
        "Exploitation"
      ]
    },
    {
      "id": "tool--cd07bd67-3e94-4fce-8c86-589ad7c314c0",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "net user/group/localgroup",
      "tool_types": [
        "Information-gathering"
      ]
    },
    {
      "id": "tool--6c9c4fd4-1e75-45c2-921c-a2df79fd4108",
      "type": "tool",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "name": "Net.exe",
      "tool_types": [
        "remote-access"
      ]
    },
    {
      "id": "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168",
      "type": "marking-definition",
      "definition": {
        "statement": "Copyright 2015-2025, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation."
      },
      "spec_version": "2.1",
      "created": "2017-06-01T00:00:00.000Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "definition_type": "statement"
    },
    {
      "id": "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4",
      "type": "extension-definition",
      "spec_version": "2.1",
      "created": "2022-08-02T19:34:35.143Z",
      "modified": "2022-08-02T19:34:35.143Z",
      "name": "Attack Flow",
      "description": "Extends STIX 2.1 with features to create Attack Flows.",
      "created_by_ref": "identity--fb9c968a-745b-4ade-9b25-c324172197f4",
      "schema": "https://center-for-threat-informed-defense.github.io/attack-flow/stix/attack-flow-schema-2.0.0.json",
      "version": "2.0.0",
      "extension_types": [
        "new-sdo"
      ],
      "external_references": [
        {
          "source_name": "Documentation",
          "description": "Documentation for Attack Flow",
          "url": "https://center-for-threat-informed-defense.github.io/attack-flow"
        },
        {
          "source_name": "GitHub",
          "description": "Source code repository for Attack Flow",
          "url": "https://github.com/center-for-threat-informed-defense/attack-flow"
        }
      ]
    },
    {
      "id": "relationship--fac046aa-776d-493f-83df-b19f18fb2f60",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "threat-actor--f5182f82-449b-4edd-9c74-bf2ad4bcaf9d",
      "target_ref": "campaign--8ed0c3ff-cecd-40f1-9d6b-e3dbe955ac7a"
    },
    {
      "id": "x-mitre-tactic--ffd5bcee-6e16-4dd2-8eca-7b3beedf33ca",
      "type": "x-mitre-tactic",
      "spec_version": "2.1",
      "created": "2018-10-17T00:14:20.652Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/tactics/TA0001",
          "external_id": "TA0001"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-25T14:45:36.917Z",
      "name": "Initial Access",
      "description": "The adversary is trying to get into your network.\n\nInitial Access consists of techniques that use various entry vectors to gain their initial foothold within a network. Techniques used to gain a foothold include targeted spearphishing and exploiting weaknesses on public-facing web servers. Footholds gained through initial access may allow for continued access, like valid accounts and use of external remote services, or may be limited-use due to changing passwords.",
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_deprecated": false,
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_version": "1.0",
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_shortname": "initial-access"
    },
    {
      "id": "attack-pattern--2b742742-28c3-4e1b-bab7-8350d6300fa7",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-03-02T19:15:44.182Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1566/002",
          "external_id": "T1566.002"
        },
        {
          "source_name": "ACSC Email Spoofing",
          "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved November 17, 2024.",
          "url": "https://web.archive.org/web/20210708014107/https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf"
        },
        {
          "source_name": "CISA IDN ST05-016",
          "description": "CISA. (2019, September 27). Security Tip (ST05-016): Understanding Internationalized Domain Names. Retrieved October 20, 2020.",
          "url": "https://us-cert.cisa.gov/ncas/tips/ST05-016"
        },
        {
          "source_name": "Trend Micro Pawn Storm OAuth 2017",
          "description": "Hacquebord, F.. (2017, April 25). Pawn Storm Abuses Open Authentication in Advanced Social Engineering Attacks. Retrieved October 4, 2019.",
          "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks"
        },
        {
          "source_name": "Netskope Device Code Phishing 2021",
          "description": "Jenko Hwong. (2021, August 10). New Phishing Attacks Exploiting OAuth Authorization Flows (Part 1). Retrieved March 19, 2024.",
          "url": "https://www.netskope.com/blog/new-phishing-attacks-exploiting-oauth-authorization-flows-part-1"
        },
        {
          "source_name": "Microsoft OAuth 2.0 Consent Phishing 2021",
          "description": "Microsoft 365 Defender Threat Intelligence Team. (2021, June 14). Microsoft delivers comprehensive solution to battle rise in consent phishing emails. Retrieved December 13, 2021.",
          "url": "https://www.microsoft.com/security/blog/2021/07/14/microsoft-delivers-comprehensive-solution-to-battle-rise-in-consent-phishing-emails/"
        },
        {
          "source_name": "Microsoft Anti Spoofing",
          "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.",
          "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide"
        },
        {
          "source_name": "Mandiant URL Obfuscation 2023",
          "description": "Nick Simonian. (2023, May 22). Don't @ Me: URL Obfuscation Through Schema Abuse. Retrieved August 4, 2023.",
          "url": "https://www.mandiant.com/resources/blog/url-obfuscation-schema-abuse"
        },
        {
          "source_name": "Optiv Device Code Phishing 2021",
          "description": "Optiv. (2021, August 17). Microsoft 365 OAuth Device Code Flow and Phishing. Retrieved March 19, 2024.",
          "url": "https://www.optiv.com/insights/source-zero/blog/microsoft-365-oauth-device-code-flow-and-phishing"
        },
        {
          "source_name": "SecureWorks Device Code Phishing 2021",
          "description": "SecureWorks Counter Threat Unit Research Team. (2021, June 3). OAuth’S Device Code Flow Abused in Phishing Attacks. Retrieved March 19, 2024.",
          "url": "https://www.secureworks.com/blog/oauths-device-code-flow-abused-in-phishing-attacks"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T23:10:41.326Z",
      "name": "Spearphishing Link",
      "description": "Adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems. Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.\n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place.\n\nAdversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly. Additionally, adversaries may use seemingly benign links that abuse special characters to mimic legitimate websites (known as an \"IDN homograph attack\").(Citation: CISA IDN ST05-016) URLs may also be obfuscated by taking advantage of quirks in the URL schema, such as the acceptance of integer- or hexadecimal-based hostname formats and the automatic discarding of text before an “@” symbol: for example, `hxxp://google.com@1157586937`.(Citation: Mandiant URL Obfuscation 2023)\n\nAdversaries may also utilize links to perform consent phishing, typically with OAuth 2.0 request URLs that when accepted by the user provide permissions/access for malicious applications, allowing adversaries to  [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s.(Citation: Trend Micro Pawn Storm OAuth 2017) These stolen access tokens allow the adversary to perform various actions on behalf of the user via API calls. (Citation: Microsoft OAuth 2.0 Consent Phishing 2021)\n\nAdversaries may also utilize spearphishing links to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s that grant immediate access to the victim environment. For example, a user may be lured through “consent phishing” into granting adversaries permissions/access via a malicious OAuth 2.0 request URL .(Citation: Trend Micro Pawn Storm OAuth 2017)(Citation: Microsoft OAuth 2.0 Consent Phishing 2021)\n\nSimilarly, malicious links may also target device-based authorization, such as OAuth 2.0 device authorization grant flow which is typically used to authenticate devices without UIs/browsers. Known as “device code phishing,” an adversary may send a link that directs the victim to a malicious authorization page where the user is tricked into entering a code/credentials that produces a device token.(Citation: SecureWorks Device Code Phishing 2021)(Citation: Netskope Device Code Phishing 2021)(Citation: Optiv Device Code Phishing 2021)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "initial-access"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Philip Winther",
        "Shailesh Tiwary (Indian Army)",
        "Mark Wee",
        "Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services)",
        "Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)",
        "Kobi Haimovich, CardinalOps",
        "Menachem Goldstein"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "URL inspection within email (including expanding shortened links) can help detect links leading to known malicious sites as well as links redirecting to adversary infrastructure based by upon suspicious OAuth patterns with unusual TLDs.(Citation: Microsoft OAuth 2.0 Consent Phishing 2021). Detonation chambers can be used to detect these links and either automatically go to these sites to determine if they're potentially malicious, or wait and capture the content if a user visits the link.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nBecause this technique usually involves user interaction on the endpoint, many of the possible detections take place once [User Execution](https://attack.mitre.org/techniques/T1204) occurs.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "SaaS",
        "Identity Provider",
        "Office Suite"
      ],
      "x_mitre_version": "2.7",
      "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Flow",
        "Application Log: Application Log Content",
        "Network Traffic: Network Traffic Content"
      ]
    },
    {
      "id": "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
      "type": "x-mitre-tactic",
      "spec_version": "2.1",
      "created": "2018-10-17T00:14:20.652Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/tactics/TA0005",
          "external_id": "TA0005"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-25T14:45:34.581Z",
      "name": "Defense Evasion",
      "description": "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_deprecated": false,
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_version": "1.0",
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_shortname": "defense-evasion"
    },
    {
      "id": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2017-12-14T16:46:06.044Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1140",
          "external_id": "T1140"
        },
        {
          "source_name": "Volexity PowerDuke November 2016",
          "description": "Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017.",
          "url": "https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/"
        },
        {
          "source_name": "Sentinel One Tainted Love 2023",
          "description": "Aleksandar Milenkoski, Juan Andres Guerrero-Saade, and Joey Chen. (2023, March 23). Operation Tainted Love | Chinese APTs Target Telcos in New Attacks. Retrieved March 18, 2025.",
          "url": "https://www.sentinelone.com/labs/operation-tainted-love-chinese-apts-target-telcos-in-new-attacks/"
        },
        {
          "source_name": "Malwarebytes Targeted Attack against Saudi Arabia",
          "description": "Malwarebytes Labs. (2017, March 27). New targeted attack against Saudi Arabia Government. Retrieved July 3, 2017.",
          "url": "https://blog.malwarebytes.com/cybercrime/social-engineering-cybercrime/2017/03/new-targeted-attack-saudi-arabia-government/"
        },
        {
          "source_name": "Carbon Black Obfuscation Sept 2016",
          "description": "Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018.",
          "url": "https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:24.400Z",
      "name": "Deobfuscate/Decode Files or Information",
      "description": "Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system.\n\nOne such example is the use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file.(Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> or <code>type</code> command to reassemble binary fragments into a malicious payload.(Citation: Carbon Black Obfuscation Sept 2016)(Citation: Sentinel One Tainted Love 2023)\n\nSometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary.(Citation: Volexity PowerDuke November 2016)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "defense-evasion"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Matthew Demaske, Adaptforward",
        "Red Canary",
        "Cristóbal Martínez Martín"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Detecting the action of deobfuscating or decoding files or information may be difficult depending on the implementation. If the functionality is contained within malware and uses the Windows API, then attempting to detect malicious behavior before or after the action may yield better results than attempting to perform analysis on loaded libraries or API calls. If scripts are used, then collecting the scripts for analysis may be necessary. Perform process and command-line monitoring to detect potentially malicious behavior related to scripts and system utilities such as [certutil](https://attack.mitre.org/software/S0160).\n\nMonitor the execution file paths and command-line arguments for common archive file applications and extensions, such as those for Zip and RAR archive tools, and correlate with other suspicious behavior to reduce false positives from normal user and administrator behavior.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": false,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "ESXi",
        "Linux",
        "Windows",
        "macOS"
      ],
      "x_mitre_version": "1.4",
      "x_mitre_data_sources": [
        "Process: Process Creation",
        "Script: Script Execution",
        "File: File Modification"
      ]
    },
    {
      "id": "attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-03-02T19:05:18.137Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1566/001",
          "external_id": "T1566.001"
        },
        {
          "source_name": "ACSC Email Spoofing",
          "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved November 17, 2024.",
          "url": "https://web.archive.org/web/20210708014107/https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf"
        },
        {
          "source_name": "Unit 42 DarkHydrus July 2018",
          "description": "Falcone, R., et al. (2018, July 27). New Threat Actor Group DarkHydrus Targets Middle East Government. Retrieved August 2, 2018.",
          "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/"
        },
        {
          "source_name": "Microsoft Anti Spoofing",
          "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.",
          "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide"
        },
        {
          "source_name": "Elastic - Koadiac Detection with EQL",
          "description": "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 17, 2024.",
          "url": "https://www.elastic.co/security-labs/embracing-offensive-tooling-building-detections-against-koadic-using-eql"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T23:10:26.686Z",
      "name": "Spearphishing Attachment",
      "description": "Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution.(Citation: Unit 42 DarkHydrus July 2018) Spearphishing may also involve social engineering techniques, such as posing as a trusted source.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. ",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "initial-access"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Philip Winther"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Network intrusion detection systems and email gateways can be used to detect spearphishing with malicious attachments in transit. Detonation chambers may also be used to identify malicious attachments. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nAnti-virus can potentially detect malicious documents and attachments as they're scanned to be stored on the email server or on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the attachment is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning Powershell.exe) for techniques such as [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203) or usage of malicious scripts.\n\nMonitor for suspicious descendant process spawning from Microsoft Office and other productivity software.(Citation: Elastic - Koadiac Detection with EQL)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "macOS",
        "Windows",
        "Linux"
      ],
      "x_mitre_version": "2.2",
      "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Traffic Flow",
        "Application Log: Application Log Content",
        "File: File Creation"
      ]
    },
    {
      "id": "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
      "type": "x-mitre-tactic",
      "spec_version": "2.1",
      "created": "2018-10-17T00:14:20.652Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/tactics/TA0003",
          "external_id": "TA0003"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-25T14:45:33.492Z",
      "name": "Persistence",
      "description": "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_deprecated": false,
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_version": "1.0",
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_shortname": "persistence"
    },
    {
      "id": "attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2019-11-27T14:58:00.429Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1053/005",
          "external_id": "T1053.005"
        },
        {
          "source_name": "ProofPoint Serpent",
          "description": "Campbell, B. et al. (2022, March 21). Serpent, No Swiping! New Backdoor Targets French Entities with Unique Attack Chain. Retrieved April 11, 2022.",
          "url": "https://www.proofpoint.com/us/blog/threat-insight/serpent-no-swiping-new-backdoor-targets-french-entities-unique-attack-chain"
        },
        {
          "source_name": "Defending Against Scheduled Task Attacks in Windows Environments",
          "description": "Harshal Tupsamudre. (2022, June 20). Defending Against Scheduled Tasks. Retrieved July 5, 2022.",
          "url": "https://blog.qualys.com/vulnerabilities-threat-research/2022/06/20/defending-against-scheduled-task-attacks-in-windows-environments"
        },
        {
          "source_name": "Twitter Leoloobeek Scheduled Task",
          "description": "Loobeek, L. (2017, December 8). leoloobeek Status. Retrieved September 12, 2024.",
          "url": "https://x.com/leoloobeek/status/939248813465853953"
        },
        {
          "source_name": "Tarrask scheduled task",
          "description": "Microsoft Threat Intelligence Team & Detection and Response Team . (2022, April 12). Tarrask malware uses scheduled tasks for defense evasion. Retrieved June 1, 2022.",
          "url": "https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/"
        },
        {
          "source_name": "Microsoft Scheduled Task Events Win10",
          "description": "Microsoft. (2017, May 28). Audit Other Object Access Events. Retrieved June 27, 2019.",
          "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-other-object-access-events"
        },
        {
          "source_name": "TechNet Scheduled Task Events",
          "description": "Microsoft. (n.d.). General Task Registration. Retrieved December 12, 2017.",
          "url": "https://technet.microsoft.com/library/dd315590.aspx"
        },
        {
          "source_name": "Red Canary - Atomic Red Team",
          "description": "Red Canary - Atomic Red Team. (n.d.). T1053.005 - Scheduled Task/Job: Scheduled Task. Retrieved June 19, 2024.",
          "url": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.005/T1053.005.md"
        },
        {
          "source_name": "TechNet Autoruns",
          "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
          "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
        },
        {
          "source_name": "TechNet Forum Scheduled Task Operational Setting",
          "description": "Satyajit321. (2015, November 3). Scheduled Tasks History Retention settings. Retrieved December 12, 2017.",
          "url": "https://social.technet.microsoft.com/Forums/en-US/e5bca729-52e7-4fcb-ba12-3225c564674c/scheduled-tasks-history-retention-settings?forum=winserver8gen"
        },
        {
          "source_name": "SigmaHQ",
          "description": "Sittikorn S. (2022, April 15). Removal Of SD Value to Hide Schedule Task - Registry. Retrieved June 1, 2022.",
          "url": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_delete/registry_delete_schtasks_hide_task_via_sd_value_removal.yml"
        },
        {
          "source_name": "Stack Overflow",
          "description": "Stack Overflow. (n.d.). How to find the location of the Scheduled Tasks folder. Retrieved June 19, 2024.",
          "url": "https://stackoverflow.com/questions/2913816/how-to-find-the-location-of-the-scheduled-tasks-folder"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:01.010Z",
      "name": "Scheduled Task",
      "description": "Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The [schtasks](https://attack.mitre.org/software/S0111) utility can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel.(Citation: Stack Overflow) In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) (WMI) to create a scheduled task. Adversaries may also utilize the Powershell Cmdlet `Invoke-CimMethod`, which leverages WMI class `PS_ScheduledTask` to create a scheduled task via an XML path.(Citation: Red Canary - Atomic Red Team)\n\nAn adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and/or to run a process under the context of a specified account (such as SYSTEM). Similar to [System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218), adversaries have also abused the Windows Task Scheduler to potentially mask one-time execution under signed/trusted system processes.(Citation: ProofPoint Serpent)\n\nAdversaries may also create \"hidden\" scheduled tasks (i.e. [Hide Artifacts](https://attack.mitre.org/techniques/T1564)) that may not be visible to defender tools and manual queries used to enumerate tasks. Specifically, an adversary may hide a task from `schtasks /query` and the Task Scheduler by deleting the associated Security Descriptor (SD) registry value (where deletion of this value must be completed using SYSTEM permissions).(Citation: SigmaHQ)(Citation: Tarrask scheduled task) Adversaries may also employ alternate methods to hide tasks, such as altering the metadata (e.g., `Index` value) within associated registry keys.(Citation: Defending Against Scheduled Task Attacks in Windows Environments) ",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "execution"
        },
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "persistence"
        },
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "privilege-escalation"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Andrew Northern, @ex_raritas",
        "Bryan Campbell, @bry_campbell",
        "Zachary Abzug, @ZackDoesML",
        "Selena Larson, @selenalarson",
        "Sittikorn Sangrattanapitak"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Monitor process execution from the <code>svchost.exe</code> in Windows 10 and the Windows Task Scheduler <code>taskeng.exe</code> for older versions of Windows. (Citation: Twitter Leoloobeek Scheduled Task) If scheduled tasks are not used for persistence, then the adversary is likely to remove the task when the action is complete. Monitor Windows Task Scheduler stores in %systemroot%\\System32\\Tasks for change entries related to scheduled tasks that do not correlate with known software, patch cycles, etc.\n\nConfigure event logging for scheduled task creation and changes by enabling the \"Microsoft-Windows-TaskScheduler/Operational\" setting within the event logging service. (Citation: TechNet Forum Scheduled Task Operational Setting) Several events will then be logged on scheduled task activity, including: (Citation: TechNet Scheduled Task Events)(Citation: Microsoft Scheduled Task Events Win10)\n\n* Event ID 106 on Windows 7, Server 2008 R2 - Scheduled task registered\n* Event ID 140 on Windows 7, Server 2008 R2 / 4702 on Windows 10, Server 2016 - Scheduled task updated\n* Event ID 141 on Windows 7, Server 2008 R2 / 4699 on Windows 10, Server 2016 - Scheduled task deleted\n* Event ID 4698 on Windows 10, Server 2016 - Scheduled task created\n* Event ID 4700 on Windows 10, Server 2016 - Scheduled task enabled\n* Event ID 4701 on Windows 10, Server 2016 - Scheduled task disabled\n\nTools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing current scheduled tasks. (Citation: TechNet Autoruns)\n\nRemote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. Tasks may also be created through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.7",
      "x_mitre_data_sources": [
        "Windows Registry: Windows Registry Key Creation",
        "File: File Modification",
        "File: File Creation",
        "Process: Process Creation",
        "Command: Command Execution",
        "Network Traffic: Network Traffic Flow",
        "Scheduled Job: Scheduled Job Creation"
      ]
    },
    {
      "id": "attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-03-09T13:48:55.078Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1059/001",
          "external_id": "T1059.001"
        },
        {
          "source_name": "Microsoft PSfromCsharp APR 2014",
          "description": "Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019.",
          "url": "https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/"
        },
        {
          "source_name": "SilentBreak Offensive PS Dec 2015",
          "description": "Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018.",
          "url": "https://web.archive.org/web/20190508170150/https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/"
        },
        {
          "source_name": "FireEye PowerShell Logging 2016",
          "description": "Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016.",
          "url": "https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html"
        },
        {
          "source_name": "Github PSAttack",
          "description": "Haight, J. (2016, April 21). PS>Attack. Retrieved September 27, 2024.",
          "url": "https://github.com/Exploit-install/PSAttack-1"
        },
        {
          "source_name": "inv_ps_attacks",
          "description": "Hastings, M. (2014, July 16). Investigating PowerShell Attacks. Retrieved December 1, 2021.",
          "url": "https://powershellmagazine.com/2014/07/16/investigating-powershell-attacks/"
        },
        {
          "source_name": "Malware Archaeology PowerShell Cheat Sheet",
          "description": "Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016.",
          "url": "http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf"
        },
        {
          "source_name": "TechNet PowerShell",
          "description": "Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016.",
          "url": "https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx"
        },
        {
          "source_name": "Sixdub PowerPick Jan 2016",
          "description": "Warner, J.. (2015, January 6). Inexorable PowerShell – A Red Teamer’s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018.",
          "url": "https://web.archive.org/web/20160327101330/http://www.sixdub.net/?p=367"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:52.378Z",
      "name": "PowerShell",
      "description": "Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system.(Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).\n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  [PowerSploit](https://attack.mitre.org/software/S0194), [PoshC2](https://attack.mitre.org/software/S0378), and PSAttack.(Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)(Citation: Microsoft PSfromCsharp APR 2014)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "execution"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Mayuresh Dani, Qualys",
        "Praetorian",
        "Ross Brittain"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "If proper execution policy is set, adversaries will likely be able to define their own execution policy if they obtain administrator or system access, either through the Registry or at the command line. This change in policy on a system may be a way to detect malicious use of PowerShell. If PowerShell is not used in an environment, then simply looking for PowerShell execution may detect malicious activity.\n\nMonitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System.Management.Automation.dll (especially to unusual process names/locations).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)\n\nIt is also beneficial to turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). (Citation: Malware Archaeology PowerShell Cheat Sheet) PowerShell 5.0 introduced enhanced logging capabilities, and some of those features have since been added to PowerShell 4.0. Earlier versions of PowerShell do not have many logging features.(Citation: FireEye PowerShell Logging 2016) An organization can gather PowerShell execution details in a data analytic platform to supplement it with other data.\n\nConsider monitoring for Windows event ID (EID) 400, which shows the version of PowerShell executing in the <code>EngineVersion</code> field (which may also be relevant to detecting a potential [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)) as well as if PowerShell is running locally or remotely in the <code>HostName</code> field. Furthermore, EID 400 may indicate the start time and EID 403 indicates the end time of a PowerShell session.(Citation: inv_ps_attacks)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.5",
      "x_mitre_data_sources": [
        "Script: Script Execution",
        "Process: Process Creation",
        "Process: Process Metadata",
        "Command: Command Execution",
        "Module: Module Load"
      ]
    },
    {
      "id": "x-mitre-tactic--4ca45d45-df4d-4613-8980-bac22d278fa5",
      "type": "x-mitre-tactic",
      "spec_version": "2.1",
      "created": "2018-10-17T00:14:20.652Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/tactics/TA0002",
          "external_id": "TA0002"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-25T14:45:32.769Z",
      "name": "Execution",
      "description": "The adversary is trying to run malicious code.\n\nExecution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery. ",
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_deprecated": false,
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_version": "1.0",
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_shortname": "execution"
    },
    {
      "id": "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-01-23T22:02:48.566Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1547/001",
          "external_id": "T1547.001"
        },
        {
          "source_name": "Malwarebytes Wow6432Node 2016",
          "description": "Arntz, P. (2016, March 30). Hiding in Plain Sight. Retrieved August 3, 2020.",
          "url": "https://blog.malwarebytes.com/cybercrime/2013/10/hiding-in-plain-sight/"
        },
        {
          "source_name": "Microsoft Wow6432Node 2018",
          "description": "Microsoft. (2018, May 31). 32-bit and 64-bit Application Data in the Registry. Retrieved August 3, 2020.",
          "url": "https://docs.microsoft.com/en-us/windows/win32/sysinfo/32-bit-and-64-bit-application-data-in-the-registry"
        },
        {
          "source_name": "Microsoft Run Key",
          "description": "Microsoft. (n.d.). Run and RunOnce Registry Keys. Retrieved September 12, 2024.",
          "url": "https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys"
        },
        {
          "source_name": "Oddvar Moe RunOnceEx Mar 2018",
          "description": "Moe, O. (2018, March 21). Persistence using RunOnceEx - Hidden from Autoruns.exe. Retrieved June 29, 2018.",
          "url": "https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/"
        },
        {
          "source_name": "TechNet Autoruns",
          "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
          "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:54.099Z",
      "name": "Registry Run Keys / Startup Folder",
      "description": "Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.(Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nThe following run keys are created by default on Windows systems:\n\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n\nRun keys may exist under multiple hives.(Citation: Microsoft Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.(Citation: Microsoft Run Key) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nPlacing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\\Users\\\\[Username]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup</code>. The startup folder path for all users is <code>C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp</code>.\n\nThe following Registry keys can be used to set startup folder items for persistence:\n\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n\nThe following Registry keys can control automatic startup of services during boot:\n\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\n\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> run automatically for the currently logged-on user.\n\nBy default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "persistence"
        },
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "privilege-escalation"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Oddvar Moe, @oddvarmoe",
        "Dray Agha, @Purp1eW0lf, Huntress Labs",
        "Harun Küßner"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, etc. Monitor the start folder for additions or changes. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations and startup folders. (Citation: TechNet Autoruns) Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.\n\nChanges to these locations typically happen under normal conditions when legitimate software is installed. To increase confidence of malicious activity, data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "2.1",
      "x_mitre_data_sources": [
        "Command: Command Execution",
        "File: File Modification",
        "Process: Process Creation",
        "Windows Registry: Windows Registry Key Creation",
        "Windows Registry: Windows Registry Key Modification"
      ]
    },
    {
      "id": "attack-pattern--f2857333-11d4-45bf-b064-2c28d8525be5",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-03-13T20:33:00.009Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1564/004",
          "external_id": "T1564.004"
        },
        {
          "source_name": "MalwareBytes ADS July 2015",
          "description": "Arntz, P. (2015, July 22). Introduction to Alternate Data Streams. Retrieved March 21, 2018.",
          "url": "https://blog.malwarebytes.com/101/2015/07/introduction-to-alternate-data-streams/"
        },
        {
          "source_name": "SpectorOps Host-Based Jul 2017",
          "description": "Atkinson, J. (2017, July 18). Host-based Threat Modeling & Indicator Design. Retrieved March 21, 2018.",
          "url": "https://posts.specterops.io/host-based-threat-modeling-indicator-design-a9dbbb53d5ea"
        },
        {
          "source_name": "Journey into IR ZeroAccess NTFS EA",
          "description": "Harrell, C. (2012, December 11). Extracting ZeroAccess from NTFS Extended Attributes. Retrieved June 3, 2016.",
          "url": "http://journeyintoir.blogspot.com/2012/12/extracting-zeroaccess-from-ntfs.html"
        },
        {
          "source_name": "Microsoft NTFS File Attributes Aug 2010",
          "description": "Hughes, J. (2010, August 25). NTFS File Attributes. Retrieved March 21, 2018.",
          "url": "https://blogs.technet.microsoft.com/askcore/2010/08/25/ntfs-file-attributes/"
        },
        {
          "source_name": "Microsoft ADS Mar 2014",
          "description": "Marlin, J. (2013, March 24). Alternate Data Streams in NTFS. Retrieved March 21, 2018.",
          "url": "https://blogs.technet.microsoft.com/askcore/2013/03/24/alternate-data-streams-in-ntfs/"
        },
        {
          "source_name": "Microsoft File Streams",
          "description": "Microsoft. (n.d.). File Streams. Retrieved September 12, 2024.",
          "url": "https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams"
        },
        {
          "source_name": "Oddvar Moe ADS2 Apr 2018",
          "description": "Moe, O. (2018, April 11). Putting Data in Alternate Data Streams and How to Execute It - Part 2. Retrieved June 30, 2018.",
          "url": "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/"
        },
        {
          "source_name": "Oddvar Moe ADS1 Jan 2018",
          "description": "Moe, O. (2018, January 14). Putting Data in Alternate Data Streams and How to Execute It. Retrieved June 30, 2018.",
          "url": "https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/"
        },
        {
          "source_name": "Symantec ADS May 2009",
          "description": "Pravs. (2009, May 25). What you need to know about alternate data streams in windows? Is your Data secure? Can you restore that?. Retrieved March 21, 2018.",
          "url": "https://www.symantec.com/connect/articles/what-you-need-know-about-alternate-data-streams-windows-your-data-secure-can-you-restore"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:59:20.821Z",
      "name": "NTFS File Attributes",
      "description": "Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection. Every New Technology File System (NTFS) formatted partition contains a Master File Table (MFT) that maintains a record for every file/directory on the partition. (Citation: SpectorOps Host-Based Jul 2017) Within MFT entries are file attributes, (Citation: Microsoft NTFS File Attributes Aug 2010) such as Extended Attributes (EA) and Data [known as Alternate Data Streams (ADSs) when more than one Data attribute is present], that can be used to store arbitrary data (and even complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: Microsoft File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014)\n\nAdversaries may store malicious data or binaries in file attribute metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus. (Citation: Journey into IR ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "defense-evasion"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Oddvar Moe, @oddvarmoe",
        "Red Canary"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Forensic techniques exist to identify information stored in NTFS EA. (Citation: Journey into IR ZeroAccess NTFS EA) Monitor calls to the <code>ZwSetEaFile</code> and <code>ZwQueryEaFile</code> Windows API functions as well as binaries used to interact with EA, (Citation: Oddvar Moe ADS1 Jan 2018) (Citation: Oddvar Moe ADS2 Apr 2018) and consider regularly scanning for the presence of modified information. (Citation: SpectorOps Host-Based Jul 2017)\n\nThere are many ways to create and interact with ADSs using Windows utilities. Monitor for operations (execution, copies, etc.) with file names that contain colons. This syntax (ex: <code>file.ext:ads[.ext]</code>) is commonly associated with ADSs. (Citation: Microsoft ADS Mar 2014) (Citation: Oddvar Moe ADS1 Jan 2018) (Citation: Oddvar Moe ADS2 Apr 2018) For a more exhaustive list of utilities that can be used to execute and create ADSs, see https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f.\n\nThe Streams tool of Sysinternals can be used to uncover files with ADSs. The <code>dir /r</code> command can also be used to display ADSs. (Citation: Symantec ADS May 2009) Many PowerShell commands (such as Get-Item, Set-Item, Remove-Item, and Get-ChildItem) can also accept a <code>-stream</code> parameter to interact with ADSs. (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.2",
      "x_mitre_data_sources": [
        "Command: Command Execution",
        "File: File Modification",
        "Process: Process Creation",
        "File: File Metadata",
        "Process: OS API Execution"
      ]
    },
    {
      "id": "attack-pattern--2959d63f-73fd-46a1-abd2-109d7dcede32",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-01-17T19:13:50.402Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1543/003",
          "external_id": "T1543.003"
        },
        {
          "source_name": "Microsoft Windows Event Forwarding FEB 2018",
          "description": "Hardy, T. & Hall, J. (2018, February 15). Use Windows Event Forwarding to help with intrusion detection. Retrieved August 7, 2018.",
          "url": "https://docs.microsoft.com/windows/security/threat-protection/use-windows-event-forwarding-to-assist-in-intrusion-detection"
        },
        {
          "source_name": "ESET InvisiMole June 2020",
          "description": "Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.",
          "url": "https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_InvisiMole.pdf"
        },
        {
          "source_name": "SANS 1",
          "description": "Joshua Wright. (2020, October 13). Retrieved March 22, 2024.",
          "url": "https://www.sans.org/blog/red-team-tactics-hiding-windows-services/"
        },
        {
          "source_name": "SANS 2",
          "description": "Joshua Wright. (2020, October 14). Retrieved March 22, 2024.",
          "url": "https://www.sans.org/blog/defense-spotlight-finding-hidden-windows-services/"
        },
        {
          "source_name": "TechNet Services",
          "description": "Microsoft. (n.d.). Services. Retrieved June 7, 2016.",
          "url": "https://technet.microsoft.com/en-us/library/cc772408.aspx"
        },
        {
          "source_name": "Microsoft 4697 APR 2017",
          "description": "Miroshnikov, A. & Hall, J. (2017, April 18). 4697(S): A service was installed in the system. Retrieved August 7, 2018.",
          "url": "https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4697"
        },
        {
          "source_name": "Symantec W.32 Stuxnet Dossier",
          "description": "Nicolas Falliere, Liam O. Murchu, Eric Chien. (2011, February). W32.Stuxnet Dossier. Retrieved December 7, 2020.",
          "url": "https://www.wired.com/images_blogs/threatlevel/2010/11/w32_stuxnet_dossier.pdf"
        },
        {
          "source_name": "Unit42 AcidBox June 2020",
          "description": "Reichel, D. and Idrizovic, E. (2020, June 17). AcidBox: Rare Malware Repurposing Turla Group Exploit Targeted Russian Organizations. Retrieved March 16, 2021.",
          "url": "https://unit42.paloaltonetworks.com/acidbox-rare-malware/"
        },
        {
          "source_name": "TechNet Autoruns",
          "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
          "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
        },
        {
          "source_name": "Crowdstrike DriveSlayer February 2022",
          "description": "Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.",
          "url": "https://www.crowdstrike.com/blog/how-crowdstrike-falcon-protects-against-wiper-malware-used-in-ukraine-attacks/"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:16.076Z",
      "name": "Windows Service",
      "description": "Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions.(Citation: TechNet Services) Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry.\n\nAdversaries may install a new service or modify an existing service to execute at startup in order to persist on a system. Service configurations can be set or modified using system utilities (such as sc.exe), by directly modifying the Registry, or by interacting directly with the Windows API. \n\nAdversaries may also use services to install and execute malicious drivers. For example, after dropping a driver file (ex: `.sys`) to disk, the payload can be loaded and registered via [Native API](https://attack.mitre.org/techniques/T1106) functions such as `CreateServiceW()` (or manually via functions such as `ZwLoadDriver()` and `ZwSetValueKey()`), by creating the required service Registry values (i.e. [Modify Registry](https://attack.mitre.org/techniques/T1112)), or by using command-line utilities such as `PnPUtil.exe`.(Citation: Symantec W.32 Stuxnet Dossier)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Unit42 AcidBox June 2020) Adversaries may leverage these drivers as [Rootkit](https://attack.mitre.org/techniques/T1014)s to hide the presence of malicious activity on a system. Adversaries may also load a signed yet vulnerable driver onto a compromised machine (known as \"Bring Your Own Vulnerable Driver\" (BYOVD)) as part of [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020)\n\nServices may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges. Adversaries may also directly start services through [Service Execution](https://attack.mitre.org/techniques/T1569/002).\n\nTo make detection analysis more challenging, malicious services may also incorporate [Masquerade Task or Service](https://attack.mitre.org/techniques/T1036/004) (ex: using a service and/or payload name related to a legitimate OS or benign software component). Adversaries may also create ‘hidden’ services (i.e., [Hide Artifacts](https://attack.mitre.org/techniques/T1564)), for example by using the `sc sdset` command to set service permissions via the Service Descriptor Definition Language (SDDL). This may hide a Windows service from the view of standard service enumeration methods such as `Get-Service`, `sc query`, and `services.exe`.(Citation: SANS 1)(Citation: SANS 2)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "persistence"
        },
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "privilege-escalation"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Matthew Demaske, Adaptforward",
        "Pedro Harrison",
        "Mayuresh Dani, Qualys",
        "Wietze Beukema, @wietze",
        "Akshat Pradhan, Qualys",
        "Wirapong Petshagun"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Monitor processes and command-line arguments for actions that could create or modify services. Command-line invocation of tools capable of adding or modifying services may be unusual, depending on how systems are typically used in a particular environment. Services may also be modified through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001), so additional logging may need to be configured to gather the appropriate data. Remote access tools with built-in features may also interact directly with the Windows API to perform these functions outside of typical system utilities. Collect service utility execution and service binary path arguments used for analysis. Service binary paths may even be changed to execute commands or scripts.  \n\nLook for changes to service Registry entries that do not correlate with known software, patch cycles, etc. Service information is stored in the Registry at <code>HKLM\\SYSTEM\\CurrentControlSet\\Services</code>. Changes to the binary path and the service startup type changed from manual or disabled to automatic, if it does not typically do so, may be suspicious. Tools such as Sysinternals Autoruns may also be used to detect system service changes that could be attempts at persistence.(Citation: TechNet Autoruns)  \n\nCreation of new services may generate an alterable event (ex: Event ID 4697 and/or 7045 (Citation: Microsoft 4697 APR 2017)(Citation: Microsoft Windows Event Forwarding FEB 2018)). New, benign services may be created during installation of new software.\n\nSuspicious program execution through services may show up as outlier processes that have not been seen before when compared against historical data. Look for abnormal process call trees from known services and for execution of other commands that could relate to Discovery or other adversary techniques. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.6",
      "x_mitre_data_sources": [
        "Windows Registry: Windows Registry Key Modification",
        "Process: Process Creation",
        "Network Traffic: Network Traffic Flow",
        "Service: Service Creation",
        "Command: Command Execution",
        "File: File Metadata",
        "Windows Registry: Windows Registry Key Creation",
        "Driver: Driver Load",
        "Service: Service Modification",
        "Process: OS API Execution"
      ]
    },
    {
      "id": "attack-pattern--2c4d4e92-0ccf-4a97-b54c-86d662988a53",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2017-12-14T16:46:06.044Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1137",
          "external_id": "T1137"
        },
        {
          "source_name": "Microsoft Detect Outlook Forms",
          "description": "Fox, C., Vangel, D. (2018, April 22). Detect and Remediate Outlook Rules and Custom Forms Injections Attacks in Office 365. Retrieved February 4, 2019.",
          "url": "https://docs.microsoft.com/en-us/office365/securitycompliance/detect-and-remediate-outlook-rules-forms-attack"
        },
        {
          "source_name": "TechNet O365 Outlook Rules",
          "description": "Koeller, B.. (2018, February 21). Defending Against Rules and Forms Injection. Retrieved November 5, 2019.",
          "url": "https://blogs.technet.microsoft.com/office365security/defending-against-rules-and-forms-injection/"
        },
        {
          "source_name": "CrowdStrike Outlook Forms",
          "description": "Parisi, T., et al. (2017, July). Using Outlook Forms for Lateral Movement and Persistence. Retrieved February 5, 2019.",
          "url": "https://malware.news/t/using-outlook-forms-for-lateral-movement-and-persistence/13746"
        },
        {
          "source_name": "SensePost Ruler GitHub",
          "description": "SensePost. (2016, August 18). Ruler: A tool to abuse Exchange services. Retrieved February 4, 2019.",
          "url": "https://github.com/sensepost/ruler"
        },
        {
          "source_name": "SensePost NotRuler",
          "description": "SensePost. (2017, September 21). NotRuler - The opposite of Ruler, provides blue teams with the ability to detect Ruler usage against Exchange. Retrieved February 4, 2019.",
          "url": "https://github.com/sensepost/notruler"
        },
        {
          "source_name": "Outlook Today Home Page",
          "description": "Soutcast. (2018, September 14). Outlook Today Homepage Persistence. Retrieved February 5, 2019.",
          "url": "https://medium.com/@bwtech789/outlook-today-homepage-persistence-33ea9b505943"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T22:54:32.990Z",
      "name": "Office Application Startup",
      "description": "Adversaries may leverage Microsoft Office-based applications for persistence between startups. Microsoft Office is a fairly common application suite on Windows-based operating systems within an enterprise network. There are multiple mechanisms that can be used with Office for persistence when an Office-based application is started; this can include the use of Office Template Macros and add-ins.\n\nA variety of features have been discovered in Outlook that can be abused to obtain persistence, such as Outlook rules, forms, and Home Page.(Citation: SensePost Ruler GitHub) These persistence mechanisms can work within Outlook or be used through Office 365.(Citation: TechNet O365 Outlook Rules)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "persistence"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Nick Carr, Mandiant",
        "Microsoft Threat Intelligence Center (MSTIC)",
        "Sahar Shukrun",
        "Praetorian",
        "Loic Jaquemet",
        "Ricardo Dias"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Collect process execution information including process IDs (PID) and parent process IDs (PPID) and look for abnormal chains of activity resulting from Office processes. Non-standard process execution trees may also indicate suspicious or malicious behavior. If winword.exe is the parent process for suspicious processes and activity relating to other adversarial techniques, then it could indicate that the application was used maliciously.\n\nMany Office-related persistence mechanisms require changes to the Registry and for binaries, files, or scripts to be written to disk or existing files modified to include malicious scripts. Collect events related to Registry key creation and modification for keys that could be used for Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Today Home Page)\n\nMicrosoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output.(Citation: Microsoft Detect Outlook Forms) SensePost, whose tool [Ruler](https://attack.mitre.org/software/S0358) can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage.(Citation: SensePost NotRuler)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": false,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows",
        "Office Suite"
      ],
      "x_mitre_version": "1.4",
      "x_mitre_data_sources": [
        "File: File Creation",
        "Application Log: Application Log Content",
        "Windows Registry: Windows Registry Key Modification",
        "File: File Modification",
        "Module: Module Load",
        "Process: Process Creation",
        "Windows Registry: Windows Registry Key Creation",
        "Command: Command Execution"
      ]
    },
    {
      "id": "attack-pattern--b97f1d35-4249-4486-a6b5-ee60ccf24fab",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-01-23T19:52:17.414Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1218/010",
          "external_id": "T1218.010"
        },
        {
          "source_name": "FireEye Regsvr32 Targeting Mongolian Gov",
          "description": "Anubhav, A., Kizhakkinan, D. (2017, February 22). Spear Phishing Techniques Used in Attacks Targeting the Mongolian Government. Retrieved February 24, 2017.",
          "url": "https://www.fireeye.com/blog/threat-research/2017/02/spear_phishing_techn.html"
        },
        {
          "source_name": "LOLBAS Regsvr32",
          "description": "LOLBAS. (n.d.). Regsvr32.exe. Retrieved July 31, 2019.",
          "url": "https://lolbas-project.github.io/lolbas/Binaries/Regsvr32/"
        },
        {
          "source_name": "Microsoft Regsvr32",
          "description": "Microsoft. (2015, August 14). How to use the Regsvr32 tool and troubleshoot Regsvr32 error messages. Retrieved June 22, 2016.",
          "url": "https://support.microsoft.com/en-us/kb/249873"
        },
        {
          "source_name": "Carbon Black Squiblydoo Apr 2016",
          "description": "Nolen, R. et al.. (2016, April 28). Threat Advisory: “Squiblydoo” Continues Trend of Attackers Using Native OS Tools to “Live off the Land”. Retrieved April 9, 2018.",
          "url": "https://www.carbonblack.com/2016/04/28/threat-advisory-squiblydoo-continues-trend-of-attackers-using-native-os-tools-to-live-off-the-land/"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-16T20:37:19.846Z",
      "name": "Regsvr32",
      "description": "Adversaries may abuse Regsvr32.exe to proxy execution of malicious code. Regsvr32.exe is a command-line program used to register and unregister object linking and embedding controls, including dynamic link libraries (DLLs), on Windows systems. The Regsvr32.exe binary may also be signed by Microsoft. (Citation: Microsoft Regsvr32)\n\nMalicious usage of Regsvr32.exe may avoid triggering security tools that may not monitor execution of, and modules loaded by, the regsvr32.exe process because of allowlists or false positives from Windows using regsvr32.exe for normal operations. Regsvr32.exe can also be used to specifically bypass application control using functionality to load COM scriptlets to execute DLLs under user permissions. Since Regsvr32.exe is network and proxy aware, the scripts can be loaded by passing a uniform resource locator (URL) to file on an external Web server as an argument during invocation. This method makes no changes to the Registry as the COM object is not actually registered, only executed. (Citation: LOLBAS Regsvr32) This variation of the technique is often referred to as a \"Squiblydoo\" and has been used in campaigns targeting governments. (Citation: Carbon Black Squiblydoo Apr 2016) (Citation: FireEye Regsvr32 Targeting Mongolian Gov)\n\nRegsvr32.exe can also be leveraged to register a COM Object used to establish persistence via [Component Object Model Hijacking](https://attack.mitre.org/techniques/T1546/015). (Citation: Carbon Black Squiblydoo Apr 2016)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "defense-evasion"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Casey Smith"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Use process monitoring to monitor the execution and arguments of regsvr32.exe. Compare recent invocations of regsvr32.exe with prior history of known good arguments and loaded files to determine anomalous and potentially adversarial activity. Command arguments used before and after the regsvr32.exe invocation may also be useful in determining the origin and purpose of the script or DLL being loaded. (Citation: Carbon Black Squiblydoo Apr 2016)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "2.2",
      "x_mitre_data_sources": [
        "Module: Module Load",
        "Command: Command Execution",
        "Network Traffic: Network Connection Creation",
        "Process: Process Creation"
      ]
    },
    {
      "id": "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
      "type": "x-mitre-tactic",
      "spec_version": "2.1",
      "created": "2018-10-17T00:14:20.652Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/tactics/TA0007",
          "external_id": "TA0007"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-25T14:45:35.302Z",
      "name": "Discovery",
      "description": "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_deprecated": false,
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_version": "1.0",
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_shortname": "discovery"
    },
    {
      "id": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2017-05-31T21:30:28.187Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1018",
          "external_id": "T1018"
        },
        {
          "source_name": "CISA AR21-126A FIVEHANDS May 2021",
          "description": "CISA. (2021, May 6). Analysis Report (AR21-126A) FiveHands Ransomware. Retrieved June 7, 2021.",
          "url": "https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a"
        },
        {
          "source_name": "Elastic - Koadiac Detection with EQL",
          "description": "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 17, 2024.",
          "url": "https://www.elastic.co/security-labs/embracing-offensive-tooling-building-detections-against-koadic-using-eql"
        },
        {
          "source_name": "US-CERT-TA18-106A",
          "description": "US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.",
          "url": "https://www.us-cert.gov/ncas/alerts/TA18-106A"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:59:15.859Z",
      "name": "Remote System Discovery",
      "description": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.\n\nAdversaries may also analyze data from local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.\n\nAdversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)  \n",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "discovery"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Daniel Stepanic, Elastic",
        "RedHuntLabs, @redhuntlabs",
        "Austin Clark, @c2defense"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nMonitor for processes that can be used to discover remote systems, such as <code>ping.exe</code> and <code>tracert.exe</code>, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": false,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network Devices",
        "ESXi"
      ],
      "x_mitre_version": "3.6",
      "x_mitre_data_sources": [
        "Command: Command Execution",
        "File: File Access",
        "Network Traffic: Network Connection Creation",
        "Process: Process Creation"
      ]
    },
    {
      "id": "attack-pattern--c325b232-d5bc-4dde-a3ec-71f3db9e8adc",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-03-15T00:40:27.503Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1001/003",
          "external_id": "T1001.003"
        },
        {
          "source_name": "Malleable-C2-U42",
          "description": "Chris Navarrete Durgesh Sangvikar Andrew Guan Yu Fu Yanhui Jia Siddhart Shibiraj. (2022, March 16). Cobalt Strike Analysis and Tutorial: How Malleable C2 Profiles Make Cobalt Strike Difficult to Detect. Retrieved September 24, 2024.",
          "url": "https://unit42.paloaltonetworks.com/cobalt-strike-malleable-c2-profile/"
        },
        {
          "source_name": "University of Birmingham C2",
          "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
          "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
        },
        {
          "source_name": "ESET Okrum July 2019",
          "description": "Hromcova, Z. (2019, July). OKRUM AND KETRICAN: AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITY. Retrieved May 6, 2020.",
          "url": "https://www.welivesecurity.com/wp-content/uploads/2019/07/ESET_Okrum_and_Ketrican.pdf"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:59:05.377Z",
      "name": "Protocol or Service Impersonation",
      "description": "Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic.  \n\nAdversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity. \n\nAdversaries may also leverage legitimate protocols to impersonate expected web traffic or trusted services. For example, adversaries may manipulate HTTP headers, URI endpoints, SSL certificates, and transmitted data to disguise C2 communications or mimic legitimate services such as Gmail, Google Drive, and Yahoo Messenger.(Citation: ESET Okrum July 2019)(Citation: Malleable-C2-U42)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "command-and-control"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "James Emery-Callcott, Emerging Threats Team, Proofpoint"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Linux",
        "Windows",
        "macOS",
        "ESXi"
      ],
      "x_mitre_version": "2.1",
      "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Content"
      ]
    },
    {
      "id": "x-mitre-tactic--f72804c5-f15a-449e-a5da-2eecd181f813",
      "type": "x-mitre-tactic",
      "spec_version": "2.1",
      "created": "2018-10-17T00:14:20.652Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/tactics/TA0011",
          "external_id": "TA0011"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-25T14:45:36.561Z",
      "name": "Command and Control",
      "description": "The adversary is trying to communicate with compromised systems to control them.\n\nCommand and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.",
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_deprecated": false,
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_version": "1.0",
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_shortname": "command-and-control"
    },
    {
      "id": "attack-pattern--1996eef1-ced3-4d7f-bf94-33298cabbf72",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-03-15T16:27:31.768Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1071/004",
          "external_id": "T1071.004"
        },
        {
          "source_name": "Medium DnsTunneling",
          "description": "Galobardes, R. (2018, October 30). Learn how easy is to bypass firewalls using DNS tunneling (and also how to block it). Retrieved March 15, 2020.",
          "url": "https://medium.com/@galolbardes/learn-how-easy-is-to-bypass-firewalls-using-dns-tunneling-and-also-how-to-block-it-3ed652f4a000"
        },
        {
          "source_name": "University of Birmingham C2",
          "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
          "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
        },
        {
          "source_name": "PAN DNS Tunneling",
          "description": "Palo Alto Networks. (n.d.). What Is DNS Tunneling?. Retrieved March 15, 2020.",
          "url": "https://www.paloaltonetworks.com/cyberpedia/what-is-dns-tunneling"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:10.065Z",
      "name": "DNS",
      "description": "Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nThe DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling) ",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "command-and-control"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Jan Petrov, Citi",
        "Chris Heald"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for DNS traffic to/from known-bad or suspicious domains.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network Devices",
        "ESXi"
      ],
      "x_mitre_version": "1.3",
      "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Traffic Flow"
      ]
    },
    {
      "id": "attack-pattern--54b4c251-1f0e-4eba-ba6b-dbc7a6f6f06b",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-03-15T16:21:45.131Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1071/003",
          "external_id": "T1071.003"
        },
        {
          "source_name": "FireEye APT28",
          "description": "FireEye. (2015). APT28: A WINDOW INTO RUSSIA’S CYBER ESPIONAGE OPERATIONS?. Retrieved August 19, 2015.",
          "url": "https://web.archive.org/web/20151022204649/https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-apt28.pdf"
        },
        {
          "source_name": "University of Birmingham C2",
          "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
          "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:32.320Z",
      "name": "Mail Protocols",
      "description": "Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as SMTP/S, POP3/S, and IMAP that carry electronic mail may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the email messages themselves. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: FireEye APT28) ",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "command-and-control"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network Devices"
      ],
      "x_mitre_version": "1.2",
      "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Traffic Flow"
      ]
    },
    {
      "id": "attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2017-05-31T21:31:04.307Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1082",
          "external_id": "T1082"
        },
        {
          "source_name": "Amazon Describe Instance",
          "description": "Amazon. (n.d.). describe-instance-information. Retrieved March 3, 2020.",
          "url": "https://docs.aws.amazon.com/cli/latest/reference/ssm/describe-instance-information.html"
        },
        {
          "source_name": "Google Instances Resource",
          "description": "Google. (n.d.). Rest Resource: instance. Retrieved March 3, 2020.",
          "url": "https://cloud.google.com/compute/docs/reference/rest/v1/instances"
        },
        {
          "source_name": "Varonis",
          "description": "Jason Hill. (2023, February 8). VMware ESXi in the Line of Ransomware Fire. Retrieved March 26, 2025.",
          "url": "https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire"
        },
        {
          "source_name": "Crowdstrike Hypervisor Jackpotting Pt 2 2021",
          "description": "Michael Dawson. (2021, August 30). Hypervisor Jackpotting, Part 2: eCrime Actors Increase Targeting of ESXi Servers with Ransomware. Retrieved March 26, 2025.",
          "url": "https://www.crowdstrike.com/en-us/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/"
        },
        {
          "source_name": "Microsoft Virutal Machine API",
          "description": "Microsoft. (2019, March 1). Virtual Machines - Get. Retrieved October 8, 2019.",
          "url": "https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get"
        },
        {
          "source_name": "20 macOS Common Tools and Techniques",
          "description": "Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.",
          "url": "https://labs.sentinelone.com/20-common-tools-techniques-used-by-macos-threat-actors-malware/"
        },
        {
          "source_name": "OSX.FairyTale",
          "description": "Phile Stokes. (2018, September 20). On the Trail of OSX.FairyTale | Adware Playing at Malware. Retrieved August 24, 2021.",
          "url": "https://www.sentinelone.com/blog/trail-osx-fairytale-adware-playing-malware/"
        },
        {
          "source_name": "US-CERT-TA18-106A",
          "description": "US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.",
          "url": "https://www.us-cert.gov/ncas/alerts/TA18-106A"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:21.308Z",
      "name": "System Information Discovery",
      "description": "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nTools such as [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather detailed system information (e.g. <code>show version</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, threat actors may gather system information from various esxcli utilities, such as `system hostname get`, `system version get`, and `storage filesystem list` (to list storage volumes).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: Varonis)\n\nInfrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.(Citation: Amazon Describe Instance)(Citation: Google Instances Resource)(Citation: Microsoft Virutal Machine API)\n\n[System Information Discovery](https://attack.mitre.org/techniques/T1082) combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools and Techniques) ",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "discovery"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Maril Vernon @shewhohacks",
        "Praetorian",
        "Austin Clark, @c2defense"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Further, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands may also be used to gather  detailed system information with built-in features native to the network device platform.  Monitor CLI activity for unexpected or unauthorized use  commands being run by non-standard users from non-standard locations. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nIn cloud-based systems, native logging can be used to identify access to certain APIs and dashboards that may contain system information. Depending on how the environment is used, that data alone may not be useful due to benign use during normal operations.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": false,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows",
        "IaaS",
        "Linux",
        "macOS",
        "Network Devices",
        "ESXi"
      ],
      "x_mitre_version": "2.6",
      "x_mitre_data_sources": [
        "Process: OS API Execution",
        "Process: Process Creation",
        "Command: Command Execution"
      ]
    },
    {
      "id": "attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2017-05-31T21:30:27.342Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1016",
          "external_id": "T1016"
        },
        {
          "source_name": "Mandiant APT41 Global Intrusion ",
          "description": "Gyler, C.,Perez D.,Jones, S.,Miller, S.. (2021, February 25). This is Not a Test: APT41 Initiates Global Intrusion Campaign Using Multiple Exploits. Retrieved February 17, 2022.",
          "url": "https://www.mandiant.com/resources/apt41-initiates-global-intrusion-campaign-using-multiple-exploits"
        },
        {
          "source_name": "Trellix Rnasomhouse 2024",
          "description": "Pham Duy Phuc, Max Kersten, Noël Keijzer, and Michaël Schrijver. (2024, February 14). RansomHouse am See. Retrieved March 26, 2025.",
          "url": "https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/"
        },
        {
          "source_name": "US-CERT-TA18-106A",
          "description": "US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.",
          "url": "https://www.us-cert.gov/ncas/alerts/TA18-106A"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:40.773Z",
      "name": "System Network Configuration Discovery",
      "description": "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).(Citation: US-CERT-TA18-106A)(Citation: Mandiant APT41 Global Intrusion ) On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command `esxcli network nic list` will retrieve the MAC address, while `esxcli network ip interface ipv4 get` will retrieve the local IPv4 address.(Citation: Trellix Rnasomhouse 2024)\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. ",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "discovery"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Austin Clark, @c2defense"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Further, {{LinkById|T1059.008} commands may also be used to gather system and network information with built-in features native to the network device platform.  Monitor CLI activity for unexpected or unauthorized use  commands being run by non-standard users from non-standard locations.  Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": false,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network Devices",
        "ESXi"
      ],
      "x_mitre_version": "1.7",
      "x_mitre_data_sources": [
        "Command: Command Execution",
        "Script: Script Execution",
        "Process: Process Creation",
        "Process: OS API Execution"
      ]
    },
    {
      "id": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2017-05-31T21:30:43.915Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1046",
          "external_id": "T1046"
        },
        {
          "source_name": "apple doco bonjour description",
          "description": "Apple Inc. (2013, April 23). Bonjour Overview. Retrieved October 11, 2021.",
          "url": "https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/NetServices/Introduction.html"
        },
        {
          "source_name": "CISA AR21-126A FIVEHANDS May 2021",
          "description": "CISA. (2021, May 6). Analysis Report (AR21-126A) FiveHands Ransomware. Retrieved June 7, 2021.",
          "url": "https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a"
        },
        {
          "source_name": "macOS APT Activity Bradley",
          "description": "Jaron Bradley. (2021, November 14). What does APT Activity Look Like on macOS?. Retrieved January 19, 2022.",
          "url": "https://themittenmac.com/what-does-apt-activity-look-like-on-macos/"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:59:15.945Z",
      "name": "Network Service Discovery",
      "description": "Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system.(Citation: CISA AR21-126A FIVEHANDS May 2021)   \n\nWithin cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.\n\nWithin macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host’s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "discovery"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Praetorian",
        "Aaron Sullivan aka ZerkerEOD"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events from legitimate remote service scanning may be uncommon, depending on the environment and how they are used. Legitimate open port and vulnerability scanning may be conducted within the environment and will need to be deconflicted with any detection capabilities developed. Network intrusion detection systems can also be used to identify scanning activity. Monitor for process use of the networks and inspect intra-network flows to detect port scans.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": false,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows",
        "IaaS",
        "Linux",
        "macOS",
        "Containers",
        "Network Devices"
      ],
      "x_mitre_version": "3.2",
      "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Flow",
        "Command: Command Execution",
        "Cloud Service: Cloud Service Enumeration"
      ]
    },
    {
      "id": "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
      "type": "x-mitre-tactic",
      "spec_version": "2.1",
      "created": "2018-10-17T00:14:20.652Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/tactics/TA0006",
          "external_id": "TA0006"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-25T14:45:32.408Z",
      "name": "Credential Access",
      "description": "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_deprecated": false,
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_version": "1.0",
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_shortname": "credential-access"
    },
    {
      "id": "attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-02-21T16:22:09.493Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1003/004",
          "external_id": "T1003.004"
        },
        {
          "source_name": "Tilbury Windows Credentials",
          "description": "Chad Tilbury. (2017, August 8). 1Windows Credentials: Attack, Mitigation, Defense. Retrieved February 21, 2020.",
          "url": "https://www.first.org/resources/papers/conf2017/Windows-Credentials-Attacks-and-Mitigation-Techniques.pdf"
        },
        {
          "source_name": "ired Dumping LSA Secrets",
          "description": "Mantvydas Baranauskas. (2019, November 16). Dumping LSA Secrets. Retrieved February 21, 2020.",
          "url": "https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsa-secrets"
        },
        {
          "source_name": "Microsoft AD Admin Tier Model",
          "description": "Microsoft. (2019, February 14). Active Directory administrative tier model. Retrieved February 21, 2020.",
          "url": "https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material?redirectedfrom=MSDN"
        },
        {
          "source_name": "Passcape LSA Secrets",
          "description": "Passcape. (n.d.). Windows LSA secrets. Retrieved February 21, 2020.",
          "url": "https://www.passcape.com/index.php?section=docsys&cmd=details&id=23"
        },
        {
          "source_name": "Powersploit",
          "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.",
          "url": "https://github.com/mattifestation/PowerSploit"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T22:44:50.491Z",
      "name": "LSA Secrets",
      "description": "Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.(Citation: Passcape LSA Secrets)(Citation: Microsoft AD Admin Tier Model)(Citation: Tilbury Windows Credentials) LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets</code>. LSA secrets can also be dumped from memory.(Citation: ired Dumping LSA Secrets)\n\n[Reg](https://attack.mitre.org/software/S0075) can be used to extract from the Registry. [Mimikatz](https://attack.mitre.org/software/S0002) can be used to extract secrets from memory.(Citation: ired Dumping LSA Secrets)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "credential-access"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Ed Williams, Trustwave, SpiderLabs"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Monitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.1",
      "x_mitre_data_sources": [
        "Windows Registry: Windows Registry Key Access",
        "Command: Command Execution"
      ]
    },
    {
      "id": "attack-pattern--4f9ca633-15c5-463c-9724-bdcd54fde541",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-02-11T18:25:28.212Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1021/002",
          "external_id": "T1021.002"
        },
        {
          "source_name": "Medium Detecting WMI Persistence",
          "description": "French, D. (2018, October 9). Detecting & Removing an Attacker’s WMI Persistence. Retrieved October 11, 2019.",
          "url": "https://medium.com/threatpunter/detecting-removing-wmi-persistence-60ccbb7dff96"
        },
        {
          "source_name": "TechNet RPC",
          "description": "Microsoft. (2003, March 28). What Is RPC?. Retrieved June 12, 2016.",
          "url": "https://technet.microsoft.com/en-us/library/cc787851.aspx"
        },
        {
          "source_name": "Microsoft Admin Shares",
          "description": "Microsoft. (n.d.). How to create and delete hidden or administrative shares on client computers. Retrieved November 20, 2014.",
          "url": "http://support.microsoft.com/kb/314984"
        },
        {
          "source_name": "Windows Event Forwarding Payne",
          "description": "Payne, J. (2015, November 23). Monitoring what matters - Windows Event Forwarding for everyone (even if you already have a SIEM.). Retrieved February 1, 2016.",
          "url": "https://docs.microsoft.com/en-us/archive/blogs/jepayne/monitoring-what-matters-windows-event-forwarding-for-everyone-even-if-you-already-have-a-siem"
        },
        {
          "source_name": "Lateral Movement Payne",
          "description": "Payne, J. (2015, November 26). Tracking Lateral Movement Part One - Special Groups and Specific Service Accounts. Retrieved February 1, 2016.",
          "url": "https://docs.microsoft.com/en-us/archive/blogs/jepayne/tracking-lateral-movement-part-one-special-groups-and-specific-service-accounts"
        },
        {
          "source_name": "Wikipedia Server Message Block",
          "description": "Wikipedia. (2017, December 16). Server Message Block. Retrieved December 21, 2017.",
          "url": "https://en.wikipedia.org/wiki/Server_Message_Block"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:29.701Z",
      "name": "SMB/Windows Admin Shares",
      "description": "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.\n\nSMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba.\n\nWindows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over SMB,(Citation: Wikipedia Server Message Block) to interact with systems using remote procedure calls (RPCs),(Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) and certain configuration and patch levels.(Citation: Microsoft Admin Shares)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "lateral-movement"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Ensure that proper logging of accounts used to log into systems is turned on and centrally collected. Windows logging is able to collect success/failure for accounts that may be used to move laterally and can be collected using tools such as Windows Event Forwarding. (Citation: Lateral Movement Payne)(Citation: Windows Event Forwarding Payne) Monitor remote login events and associated SMB activity for file transfers and remote process execution. Monitor the actions of remote users who connect to administrative shares. Monitor for use of tools and commands to connect to remote shares, such as [Net](https://attack.mitre.org/software/S0039), on the command-line interface and Discovery techniques that could be used to find remotely accessible systems.(Citation: Medium Detecting WMI Persistence)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.3",
      "x_mitre_data_sources": [
        "Network Share: Network Share Access",
        "Network Traffic: Network Traffic Flow",
        "Logon Session: Logon Session Creation",
        "Network Traffic: Network Connection Creation",
        "Process: Process Creation",
        "Command: Command Execution"
      ]
    },
    {
      "id": "x-mitre-tactic--7141578b-e50b-4dcc-bfa4-08a8dd689e9e",
      "type": "x-mitre-tactic",
      "spec_version": "2.1",
      "created": "2018-10-17T00:14:20.652Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/tactics/TA0008",
          "external_id": "TA0008"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-25T14:45:34.223Z",
      "name": "Lateral Movement",
      "description": "The adversary is trying to move through your environment.\n\nLateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. Reaching their objective often involves pivoting through multiple systems and accounts to gain. Adversaries might install their own remote access tools to accomplish Lateral Movement or use legitimate credentials with native network and operating system tools, which may be stealthier. ",
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_deprecated": false,
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_version": "1.0",
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_shortname": "lateral-movement"
    },
    {
      "id": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2017-05-31T21:30:44.329Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1047",
          "external_id": "T1047"
        },
        {
          "source_name": "FireEye WMI 2015",
          "description": "Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016.",
          "url": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf"
        },
        {
          "source_name": "Mandiant WMI",
          "description": "Mandiant. (n.d.). Retrieved February 13, 2024.",
          "url": "https://www.mandiant.com/resources/reports"
        },
        {
          "source_name": "WMI 6",
          "description": "Microsoft. (2022, June 13). BlackCat. Retrieved February 13, 2024.",
          "url": "https://www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/"
        },
        {
          "source_name": "WMI 1-3",
          "description": "Microsoft. (2023, March 7). Retrieved February 13, 2024.",
          "url": "https://learn.microsoft.com/en-us/windows/win32/wmisdk/wmi-start-page?redirectedfrom=MSDN"
        },
        {
          "source_name": "WMI 7,8",
          "description": "Microsoft. (2024, January 26). WMIC Deprecation. Retrieved February 13, 2024.",
          "url": "https://techcommunity.microsoft.com/t5/windows-it-pro-blog/wmi-command-line-wmic-utility-deprecation-next-steps/ba-p/4039242"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:01.648Z",
      "name": "Windows Management Instrumentation",
      "description": "Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is designed for programmers and is the infrastructure for management data and operations on Windows systems.(Citation: WMI 1-3) WMI is an administration feature that provides a uniform environment to access Windows system components.\n\nThe WMI service enables both local and remote access, though the latter is facilitated by [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) and [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006).(Citation: WMI 1-3) Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS.(Citation: WMI 1-3) (Citation: Mandiant WMI)\n\nAn adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for [Discovery](https://attack.mitre.org/tactics/TA0007) as well as [Execution](https://attack.mitre.org/tactics/TA0002) of commands and payloads.(Citation: Mandiant WMI) For example, `wmic.exe` can be abused by an adversary to delete shadow copies with the command `wmic.exe Shadowcopy Delete` (i.e., [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490)).(Citation: WMI 6)\n\n**Note:** `wmic.exe` is deprecated as of January of 2024, with the WMIC feature being “disabled by default” on Windows 11+. WMIC will be removed from subsequent Windows releases and replaced by [PowerShell](https://attack.mitre.org/techniques/T1059/001) as the primary WMI interface.(Citation: WMI 7,8) In addition to PowerShell and tools like `wbemtool.exe`, COM APIs can also be used to programmatically interact with WMI via C++, .NET, VBScript, etc.(Citation: WMI 7,8)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "execution"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "@ionstorm",
        "Olaf Hartong, Falcon Force",
        "Tristan Madani"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Monitor network traffic for WMI connections; the use of WMI in environments that do not typically use WMI may be suspect. Perform process monitoring to capture command-line arguments of \"wmic\" and detect commands that are used to perform remote behavior. (Citation: FireEye WMI 2015)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": false,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.6",
      "x_mitre_data_sources": [
        "Network Traffic: Network Connection Creation",
        "Process: Process Creation",
        "WMI: WMI Creation",
        "Command: Command Execution"
      ]
    },
    {
      "id": "attack-pattern--e624264c-033a-424d-9fd7-fc9c3bbdb03e",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-01-30T16:36:51.184Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1550/002",
          "external_id": "T1550.002"
        },
        {
          "source_name": "Stealthbits Overpass-the-Hash",
          "description": "Warren, J. (2019, February 26). How to Detect Overpass-the-Hash Attacks. Retrieved February 4, 2021.",
          "url": "https://stealthbits.com/blog/how-to-detect-overpass-the-hash-attacks/"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-16T20:37:22.508Z",
      "name": "Pass the Hash",
      "description": "Adversaries may “pass the hash” using stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash.\n\nWhen performing PtH, valid password hashes for the account being used are captured using a [Credential Access](https://attack.mitre.org/tactics/TA0006) technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems.\n\nAdversaries may also use stolen password hashes to \"overpass the hash.\" Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003) attacks.(Citation: Stealthbits Overpass-the-Hash)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "defense-evasion"
        },
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "lateral-movement"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Blake Strom, Microsoft 365 Defender",
        "Travis Smith, Tripwire"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Audit all logon and credential use events and review for discrepancies. Unusual remote logins that correlate with other suspicious activity (such as writing and executing binaries) may indicate malicious activity. NTLM LogonType 3 authentications that are not associated to a domain login and are not anonymous logins are suspicious.\n\nEvent ID 4768 and 4769 will also be generated on the Domain Controller when a user requests a new ticket granting ticket or service ticket. These events combined with the above activity may be indicative of an overpass the hash attempt.(Citation: Stealthbits Overpass-the-Hash)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.3",
      "x_mitre_data_sources": [
        "Logon Session: Logon Session Creation",
        "Active Directory: Active Directory Credential Request",
        "User Account: User Account Authentication"
      ]
    },
    {
      "id": "attack-pattern--7b211ac6-c815-4189-93a9-ab415deca926",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-01-30T17:03:43.072Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1550/003",
          "external_id": "T1550.003"
        },
        {
          "source_name": "CERT-EU Golden Ticket Protection",
          "description": "Abolins, D., Boldea, C., Socha, K., Soria-Machado, M. (2016, April 26). Kerberos Golden Ticket Protection. Retrieved July 13, 2017.",
          "url": "https://cert.europa.eu/static/WhitePapers/UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf"
        },
        {
          "source_name": "Campbell 2014",
          "description": "Campbell, C. (2014). The Secret Life of Krbtgt. Retrieved November 17, 2024.",
          "url": "https://defcon.org/images/defcon-22/dc-22-presentations/Campbell/DEFCON-22-Christopher-Campbell-The-Secret-Life-of-Krbtgt.pdf"
        },
        {
          "source_name": "GentilKiwi Pass the Ticket",
          "description": "Deply, B. (2014, January 13). Pass the ticket. Retrieved September 12, 2024.",
          "url": "https://web.archive.org/web/20210515214027/https://blog.gentilkiwi.com/securite/mimikatz/pass-the-ticket-kerberos"
        },
        {
          "source_name": "ADSecurity AD Kerberos Attacks",
          "description": "Metcalf, S. (2014, November 22). Mimikatz and Active Directory Kerberos Attacks. Retrieved June 2, 2016.",
          "url": "https://adsecurity.org/?p=556"
        },
        {
          "source_name": "Stealthbits Overpass-the-Hash",
          "description": "Warren, J. (2019, February 26). How to Detect Overpass-the-Hash Attacks. Retrieved February 4, 2021.",
          "url": "https://stealthbits.com/blog/how-to-detect-overpass-the-hash-attacks/"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:43.927Z",
      "name": "Pass the Ticket",
      "description": "Adversaries may “pass the ticket” using stolen Kerberos tickets to move laterally within an environment, bypassing normal system access controls. Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account's password. Kerberos authentication can be used as the first step to lateral movement to a remote system.\n\nWhen preforming PtT, valid Kerberos tickets for [Valid Accounts](https://attack.mitre.org/techniques/T1078) are captured by [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). A user's service tickets or ticket granting ticket (TGT) may be obtained, depending on the level of access. A service ticket allows for access to a particular resource, whereas a TGT can be used to request service tickets from the Ticket Granting Service (TGS) to access any resource the user has privileges to access.(Citation: ADSecurity AD Kerberos Attacks)(Citation: GentilKiwi Pass the Ticket)\n\nA [Silver Ticket](https://attack.mitre.org/techniques/T1558/002) can be obtained for services that use Kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource (e.g., SharePoint).(Citation: ADSecurity AD Kerberos Attacks)\n\nA [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) can be obtained for the domain using the Key Distribution Service account KRBTGT account NTLM hash, which enables generation of TGTs for any account in Active Directory.(Citation: Campbell 2014)\n\nAdversaries may also create a valid Kerberos ticket using other user information, such as stolen password hashes or AES keys. For example, \"overpassing the hash\" involves using a NTLM password hash to authenticate as a user (i.e. [Pass the Hash](https://attack.mitre.org/techniques/T1550/002)) while also using the password hash to create a valid Kerberos ticket.(Citation: Stealthbits Overpass-the-Hash)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "defense-evasion"
        },
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "lateral-movement"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Vincent Le Toux",
        "Ryan Becwar"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Audit all Kerberos authentication and credential use events and review for discrepancies. Unusual remote authentication events that correlate with other suspicious activity (such as writing and executing binaries) may indicate malicious activity.\n\nEvent ID 4769 is generated on the Domain Controller when using a golden ticket after the KRBTGT password has been reset twice, as mentioned in the mitigation section. The status code 0x1F indicates the action has failed due to \"Integrity check on decrypted field failed\" and indicates misuse by a previously invalidated golden ticket.(Citation: CERT-EU Golden Ticket Protection)",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows"
      ],
      "x_mitre_version": "1.2",
      "x_mitre_data_sources": [
        "User Account: User Account Authentication",
        "Logon Session: Logon Session Creation",
        "Active Directory: Active Directory Credential Request"
      ]
    },
    {
      "id": "attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2017-05-31T21:30:45.139Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1049",
          "external_id": "T1049"
        },
        {
          "source_name": "Amazon AWS VPC Guide",
          "description": "Amazon. (n.d.). What Is Amazon VPC?. Retrieved October 6, 2019.",
          "url": "https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html"
        },
        {
          "source_name": "Microsoft Azure Virtual Network Overview",
          "description": "Annamalai, N., Casey, C., Almeida, M., et. al.. (2019, June 18). What is Azure Virtual Network?. Retrieved October 6, 2019.",
          "url": "https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview"
        },
        {
          "source_name": "Google VPC Overview",
          "description": "Google. (2019, September 23). Virtual Private Cloud (VPC) network overview. Retrieved October 6, 2019.",
          "url": "https://cloud.google.com/vpc/docs/vpc"
        },
        {
          "source_name": "US-CERT-TA18-106A",
          "description": "US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.",
          "url": "https://www.us-cert.gov/ncas/alerts/TA18-106A"
        },
        {
          "source_name": "Sygnia ESXi Ransomware 2025",
          "description": "Zhongyuan Hau (Aaron), Ren Jie Yow, and Yoav Mazor. (2025, January 21). ESXi Ransomware Attacks: Stealthy Persistence through. Retrieved March 27, 2025.",
          "url": "https://www.sygnia.co/blog/esxi-ransomware-ssh-tunneling-defense-strategies/"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:58:45.496Z",
      "name": "System Network Connections Discovery",
      "description": "Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. \n\nAn adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Microsoft Azure Virtual Network Overview)(Citation: Google VPC Overview) Similarly, adversaries who gain access to network devices may also perform similar discovery activities to gather information about connected systems and services.\n\nUtilities and commands that acquire this information include [netstat](https://attack.mitre.org/software/S0104), \"net use,\" and \"net session\" with [Net](https://attack.mitre.org/software/S0039). In Mac and Linux, [netstat](https://attack.mitre.org/software/S0104) and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to \"net session\". Additionally, built-in features native to network devices and [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) may be used (e.g. <code>show ip sockets</code>, <code>show tcp brief</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, the command `esxi network ip connection list` can be used to list active network connections.(Citation: Sygnia ESXi Ransomware 2025)",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "discovery"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_contributors": [
        "Praetorian",
        "Austin Clark, @c2defense"
      ],
      "x_mitre_deprecated": false,
      "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Further, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands may also be used to gather system and network information with built-in features native to the network device platform.  Monitor CLI activity for unexpected or unauthorized use commands being run by non-standard users from non-standard locations. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": false,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows",
        "IaaS",
        "Linux",
        "macOS",
        "Network Devices",
        "ESXi"
      ],
      "x_mitre_version": "2.5",
      "x_mitre_data_sources": [
        "Process: OS API Execution",
        "Process: Process Creation",
        "Command: Command Execution"
      ]
    },
    {
      "id": "attack-pattern--dfd7cc1d-e1d8-4394-a198-97c4cab8aa67",
      "type": "attack-pattern",
      "spec_version": "2.1",
      "created": "2020-03-09T14:29:51.508Z",
      "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "revoked": false,
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1059/005",
          "external_id": "T1059.005"
        },
        {
          "source_name": "VB .NET Mar 2020",
          "description": ".NET Team. (2020, March 11). Visual Basic support planned for .NET 5.0. Retrieved June 23, 2020.",
          "url": "https://devblogs.microsoft.com/vbteam/visual-basic-support-planned-for-net-5-0/"
        },
        {
          "source_name": "Default VBS macros Blocking ",
          "description": "Kellie Eickmeyer. (2022, February 7). Helping users stay safe: Blocking internet macros by default in Office. Retrieved February 7, 2022.",
          "url": "https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805"
        },
        {
          "source_name": "Microsoft VBScript",
          "description": "Microsoft. (2011, April 19). What Is VBScript?. Retrieved March 28, 2020.",
          "url": "https://docs.microsoft.com/previous-versions//1kw29xwf(v=vs.85)"
        },
        {
          "source_name": "Microsoft VBA",
          "description": "Microsoft. (2019, June 11). Office VBA Reference. Retrieved June 23, 2020.",
          "url": "https://docs.microsoft.com/office/vba/api/overview/"
        },
        {
          "source_name": "VB Microsoft",
          "description": "Microsoft. (n.d.). Visual Basic documentation. Retrieved June 23, 2020.",
          "url": "https://docs.microsoft.com/dotnet/visual-basic/"
        },
        {
          "source_name": "Wikipedia VBA",
          "description": "Wikipedia. (n.d.). Visual Basic for Applications. Retrieved August 13, 2020.",
          "url": "https://en.wikipedia.org/wiki/Visual_Basic_for_Applications"
        }
      ],
      "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
      ],
      "modified": "2025-04-15T19:59:14.314Z",
      "name": "Visual Basic",
      "description": "Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as [Component Object Model](https://attack.mitre.org/techniques/T1559/001) and the [Native API](https://attack.mitre.org/techniques/T1106) through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core.(Citation: VB .NET Mar 2020)(Citation: VB Microsoft)\n\nDerivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications.(Citation: Microsoft VBA)(Citation: Wikipedia VBA) VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of [JavaScript](https://attack.mitre.org/techniques/T1059/007) on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support).(Citation: Microsoft VBScript)\n\nAdversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) payloads (which may also involve [Mark-of-the-Web Bypass](https://attack.mitre.org/techniques/T1553/005) to enable execution).(Citation: Default VBS macros Blocking )",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "execution"
        }
      ],
      "x_mitre_attack_spec_version": "3.2.0",
      "x_mitre_deprecated": false,
      "x_mitre_detection": "Monitor for events associated with VB execution, such as Office applications spawning processes, usage of the Windows Script Host (typically cscript.exe or wscript.exe), file activity involving VB payloads or scripts, or loading of modules associated with VB languages (ex: vbscript.dll). VB execution is likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for execution and subsequent behavior. Actions may be related to network and system information [Discovery](https://attack.mitre.org/tactics/TA0007), [Collection](https://attack.mitre.org/tactics/TA0009), or other programable post-compromise behaviors and could be used as indicators of detection leading back to the source.\n\nUnderstanding standard usage patterns is important to avoid a high number of false positives. If VB execution is restricted for normal users, then any attempts to enable related components running on a system would be considered suspicious. If VB execution is not commonly used on a system, but enabled, execution running out of cycle from patching or other administrator functions is suspicious. Payloads and scripts should be captured from the file system when possible to determine their actions and intent.",
      "x_mitre_domains": [
        "enterprise-attack"
      ],
      "x_mitre_is_subtechnique": true,
      "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
      "x_mitre_platforms": [
        "Windows",
        "macOS",
        "Linux"
      ],
      "x_mitre_version": "1.5",
      "x_mitre_data_sources": [
        "Module: Module Load",
        "Command: Command Execution",
        "Process: Process Creation",
        "Script: Script Execution"
      ]
    },
    {
      "id": "attack-action--03fd7c2f-1eab-4468-8d67-7a331b75c261",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "SMB/Windows Admin Shares",
      "tactic_id": "TA0008",
      "tactic_ref": "x-mitre-tactic--7141578b-e50b-4dcc-bfa4-08a8dd689e9e",
      "technique_id": "T1021.002",
      "technique_ref": "attack-pattern--4f9ca633-15c5-463c-9724-bdcd54fde541",
      "description": "Net.exe was used to perform lateral movement via Windows Admin Shares",
      "asset_refs": [
        "attack-asset--1eccea60-8db3-4ac0-9db2-d4eef1c3b484"
      ],
      "effect_refs": [
        "attack-operator--65620718-41a3-43e9-842a-e169a076170a"
      ]
    },
    {
      "id": "attack-action--c7ef4391-eb20-443b-91c2-cceaf0b06458",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Windows Management Instrumentation",
      "tactic_id": "TA0002",
      "tactic_ref": "x-mitre-tactic--4ca45d45-df4d-4613-8980-bac22d278fa5",
      "technique_id": "T1047",
      "technique_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055",
      "description": "WMI and 'net user' commands were used to deploy tools on remote machines",
      "effect_refs": [
        "attack-operator--65620718-41a3-43e9-842a-e169a076170a"
      ]
    },
    {
      "id": "attack-action--2a0d98d7-92cc-4087-93ad-ff1db995bec6",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Pass the Hash",
      "tactic_id": "TA0008",
      "tactic_ref": "x-mitre-tactic--7141578b-e50b-4dcc-bfa4-08a8dd689e9e",
      "technique_id": "T1550.002",
      "technique_ref": "attack-pattern--e624264c-033a-424d-9fd7-fc9c3bbdb03e",
      "description": "The attackers deployed a customized Mimikatz using stolen credentials from an administrative account, which they used to carry out a pass-the-hash attack",
      "effect_refs": [
        "attack-operator--65620718-41a3-43e9-842a-e169a076170a"
      ]
    },
    {
      "id": "attack-action--6c5276a7-4e5c-4807-957b-d1673f27aec5",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Pass the Ticket",
      "tactic_id": "TA0008",
      "tactic_ref": "x-mitre-tactic--7141578b-e50b-4dcc-bfa4-08a8dd689e9e",
      "technique_id": "T1550.003",
      "technique_ref": "attack-pattern--7b211ac6-c815-4189-93a9-ab415deca926",
      "description": "The attackers deployed a customized Mimikatz using stolen credentials from an administrative account, which they used to carry out a pass-the-ticket attack",
      "effect_refs": [
        "attack-operator--65620718-41a3-43e9-842a-e169a076170a"
      ]
    },
    {
      "id": "relationship--38904348-17b3-4bad-9ea8-b41a6de8b3e3",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--03fd7c2f-1eab-4468-8d67-7a331b75c261",
      "target_ref": "tool--6c9c4fd4-1e75-45c2-921c-a2df79fd4108"
    },
    {
      "id": "relationship--68c94e15-8050-42f7-aebb-9ba8e8975782",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--c7ef4391-eb20-443b-91c2-cceaf0b06458",
      "target_ref": "tool--1d4a5369-38f8-4b40-8390-2c3cf8f940a0"
    },
    {
      "id": "relationship--f235d966-5e95-435a-b8fb-ce4ec1e77984",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--c7ef4391-eb20-443b-91c2-cceaf0b06458",
      "target_ref": "tool--a1e3e09a-26c1-439c-8985-5bdf2ed377fa"
    },
    {
      "id": "relationship--f86f5447-f65a-4d5b-ac45-05c1ab8b1d9c",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--2a0d98d7-92cc-4087-93ad-ff1db995bec6",
      "target_ref": "tool--750c2016-1016-48d8-95ea-df5b32a8f8ee"
    },
    {
      "id": "attack-action--7ec57638-9eba-4456-af50-1a0e4804510d",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "LSA Secrets",
      "tactic_id": "TA0006",
      "tactic_ref": "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
      "technique_id": "T1003.004",
      "technique_ref": "attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc",
      "description": "Modified version of Mimikatz was used to dump credentials",
      "effect_refs": [
        "attack-action--c7ef4391-eb20-443b-91c2-cceaf0b06458",
        "attack-action--2a0d98d7-92cc-4087-93ad-ff1db995bec6",
        "attack-action--6c5276a7-4e5c-4807-957b-d1673f27aec5",
        "attack-action--03fd7c2f-1eab-4468-8d67-7a331b75c261"
      ]
    },
    {
      "id": "relationship--318aead0-4da4-4661-8958-d012ddfaafaa",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--6c5276a7-4e5c-4807-957b-d1673f27aec5",
      "target_ref": "tool--750c2016-1016-48d8-95ea-df5b32a8f8ee"
    },
    {
      "id": "attack-operator--a414b5c1-9edb-455d-b737-72205d43b17a",
      "type": "attack-operator",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "operator": "AND",
      "effect_refs": [
        "attack-action--7ec57638-9eba-4456-af50-1a0e4804510d"
      ]
    },
    {
      "id": "relationship--b8e4d978-6f0f-459a-948f-16580dde0b5a",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--7ec57638-9eba-4456-af50-1a0e4804510d",
      "target_ref": "tool--f2fac0de-8565-48ab-9ce8-d67dee1edeb6"
    },
    {
      "id": "attack-action--90c24039-8903-407d-a9a8-9960faf084e2",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "System Network Configuration Discovery",
      "tactic_id": "TA0007",
      "tactic_ref": "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
      "technique_id": "T1016",
      "technique_ref": "attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0",
      "description": "The attackers used several tools built into the Windows OS to gather information on the environment’s network configurations.",
      "effect_refs": [
        "attack-operator--a414b5c1-9edb-455d-b737-72205d43b17a"
      ]
    },
    {
      "id": "attack-action--fa7a634c-2450-499a-9bf3-a09d8e34e937",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "System Network Connections Discovery",
      "tactic_id": "TA0007",
      "tactic_ref": "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
      "technique_id": "T1049",
      "technique_ref": "attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475",
      "description": "The attackers used several tools built into the Windows OS to gather information on the environment’s network connections.",
      "effect_refs": [
        "attack-operator--a414b5c1-9edb-455d-b737-72205d43b17a"
      ]
    },
    {
      "id": "relationship--6e287ce9-8d1a-422c-b64c-628232953ba4",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--90c24039-8903-407d-a9a8-9960faf084e2",
      "target_ref": "tool--0ade6c1a-d0b5-47d2-a633-b61144024874"
    },
    {
      "id": "relationship--104997e4-a4f8-4fda-984b-0e4ed0511820",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--90c24039-8903-407d-a9a8-9960faf084e2",
      "target_ref": "tool--cd07bd67-3e94-4fce-8c86-589ad7c314c0"
    },
    {
      "id": "relationship--2b0a4041-ce69-45a9-b94f-03df7d6cfa3e",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--90c24039-8903-407d-a9a8-9960faf084e2",
      "target_ref": "tool--b1ddb6da-5c43-440d-9189-39c740659ccc"
    },
    {
      "id": "attack-operator--445fd1d0-da6d-4b9d-9bf2-35465cf2774c",
      "type": "attack-operator",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "operator": "AND",
      "effect_refs": [
        "attack-action--fa7a634c-2450-499a-9bf3-a09d8e34e937",
        "attack-action--90c24039-8903-407d-a9a8-9960faf084e2"
      ]
    },
    {
      "id": "relationship--c318fb38-5c89-4728-87eb-ec001bf9ec8f",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--fa7a634c-2450-499a-9bf3-a09d8e34e937",
      "target_ref": "tool--09b75cde-799f-432c-9920-bbf13d0eb336"
    },
    {
      "id": "attack-action--436a56c4-7998-45f2-8f4e-3e4709e3e80c",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Remote System Discovery",
      "tactic_id": "TA0007",
      "tactic_ref": "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
      "technique_id": "T1018",
      "technique_ref": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735",
      "description": "Network scanning was performed against entire ranges to gain information on open ports, services, and operating systems for remote systems",
      "effect_refs": [
        "attack-operator--445fd1d0-da6d-4b9d-9bf2-35465cf2774c"
      ]
    },
    {
      "id": "attack-action--e70b0b83-e9b0-4188-a1c1-c049cec1c48e",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "System Information Discovery",
      "tactic_id": "TA0007",
      "tactic_ref": "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
      "technique_id": "T1082",
      "technique_ref": "attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1",
      "description": "The attackers used several tools built into the Windows OS to gather information on the environment’s users.",
      "effect_refs": [
        "attack-operator--445fd1d0-da6d-4b9d-9bf2-35465cf2774c"
      ]
    },
    {
      "id": "attack-action--47a28c6a-51bc-4144-afd3-8117e2ce6828",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Network Service Discovery",
      "tactic_id": "TA0007",
      "tactic_ref": "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
      "technique_id": "T1046",
      "technique_ref": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88",
      "description": "Network scanning was performed against entire ranges to gain information on open ports, services, and operating systems",
      "effect_refs": [
        "attack-operator--445fd1d0-da6d-4b9d-9bf2-35465cf2774c"
      ]
    },
    {
      "id": "relationship--0f7bb0e9-02af-4051-a498-12aaefbb22cc",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--e70b0b83-e9b0-4188-a1c1-c049cec1c48e",
      "target_ref": "tool--e378563e-c6df-4d01-89a9-f3545cc42517"
    },
    {
      "id": "relationship--90a79328-e84c-4c6c-8a4e-8bdb611b2bad",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--e70b0b83-e9b0-4188-a1c1-c049cec1c48e",
      "target_ref": "tool--127e715e-a04a-4103-84ef-99015b27d94f"
    },
    {
      "id": "relationship--3cca2911-6967-468e-a115-3f3905ed4a3d",
      "type": "relationship",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "relationship_type": "related-to",
      "source_ref": "attack-action--e70b0b83-e9b0-4188-a1c1-c049cec1c48e",
      "target_ref": "tool--38394be6-1da8-45e2-86c4-180837bd00e8"
    },
    {
      "id": "attack-operator--f7a7356a-a39f-438a-9a59-cd6654f88363",
      "type": "attack-operator",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "operator": "AND",
      "effect_refs": [
        "attack-action--47a28c6a-51bc-4144-afd3-8117e2ce6828",
        "attack-action--436a56c4-7998-45f2-8f4e-3e4709e3e80c",
        "attack-action--e70b0b83-e9b0-4188-a1c1-c049cec1c48e"
      ]
    },
    {
      "id": "attack-action--a19b78e2-9d90-46a7-bb55-7dc533edee63",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Protocol Impersonation",
      "tactic_id": "TA0011",
      "tactic_ref": "x-mitre-tactic--f72804c5-f15a-449e-a5da-2eecd181f813",
      "technique_id": "T1001.003",
      "technique_ref": "attack-pattern--c325b232-d5bc-4dde-a3ec-71f3db9e8adc",
      "description": "Cobalt Strike's malleable C2 profiles were used to impersonate Amazon, Google Safe Browsing, Pandora, and OSCP traffic",
      "effect_refs": [
        "attack-operator--f7a7356a-a39f-438a-9a59-cd6654f88363"
      ]
    },
    {
      "id": "attack-action--bad6fe95-996c-432e-9362-e187a87ba485",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "DNS",
      "tactic_id": "TA0011",
      "tactic_ref": "x-mitre-tactic--f72804c5-f15a-449e-a5da-2eecd181f813",
      "technique_id": "T1071.004",
      "technique_ref": "attack-pattern--1996eef1-ced3-4d7f-bf94-33298cabbf72",
      "description": "DNS tunneling was used for C2 communication and data exfiltration",
      "effect_refs": [
        "attack-operator--f7a7356a-a39f-438a-9a59-cd6654f88363"
      ]
    },
    {
      "id": "attack-action--2129fd6d-9887-4a29-b550-3a598b50f641",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Mail Protocols",
      "tactic_id": "TA0011",
      "tactic_ref": "x-mitre-tactic--f72804c5-f15a-449e-a5da-2eecd181f813",
      "technique_id": "T1071.003",
      "technique_ref": "attack-pattern--54b4c251-1f0e-4eba-ba6b-dbc7a6f6f06b",
      "description": "Malicious Outlook macros were created to utilize email for C2 communication and data exfiltration",
      "effect_refs": [
        "attack-operator--f7a7356a-a39f-438a-9a59-cd6654f88363"
      ]
    },
    {
      "id": "attack-action--4c1cd5fd-27ee-4600-901a-5897e05d1b58",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Regsvr32",
      "tactic_id": "TA0005",
      "tactic_ref": "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
      "technique_id": "T1218.010",
      "technique_ref": "attack-pattern--b97f1d35-4249-4486-a6b5-ee60ccf24fab",
      "description": "Regsvr32.exe is used to download COM scriplets for malicious execution",
      "effect_refs": [
        "attack-action--bad6fe95-996c-432e-9362-e187a87ba485",
        "attack-action--a19b78e2-9d90-46a7-bb55-7dc533edee63",
        "attack-action--2129fd6d-9887-4a29-b550-3a598b50f641"
      ]
    },
    {
      "id": "attack-action--53f217bc-c353-4ada-b782-7391aaee5685",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "DLL Side-Loading",
      "tactic_id": "TA0005",
      "tactic_ref": "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
      "technique_id": "T1574.002",
      "description": "A malicious DLL file was implanted where the Windows Search Service would run and load the DLL",
      "effect_refs": [
        "attack-action--4c1cd5fd-27ee-4600-901a-5897e05d1b58"
      ]
    },
    {
      "id": "attack-operator--c75d6f51-0b7c-4b90-bd97-943385d84391",
      "type": "attack-operator",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "operator": "AND",
      "effect_refs": [
        "attack-action--53f217bc-c353-4ada-b782-7391aaee5685"
      ]
    },
    {
      "id": "attack-action--3488c178-ef07-4ba9-9007-6ca8aaff51c9",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Registry Run Keys / Startup Folder",
      "tactic_id": "TA0003",
      "tactic_ref": "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
      "technique_id": "T1547.001",
      "technique_ref": "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279",
      "description": "Windows Registry Autorun is used to execute VBScript and PowerShell scripts residing in the ProgramData folder",
      "effect_refs": [
        "attack-operator--c75d6f51-0b7c-4b90-bd97-943385d84391"
      ]
    },
    {
      "id": "attack-action--8589d97f-43fd-4d11-83a0-41e5902cfe9f",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "NTFS File Attributes",
      "tactic_id": "TA0005",
      "tactic_ref": "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
      "technique_id": "T1564.004",
      "technique_ref": "attack-pattern--f2857333-11d4-45bf-b064-2c28d8525be5",
      "description": "Payloads for persistence were hidden in NTFS Alternate Data Streams",
      "effect_refs": [
        "attack-operator--c75d6f51-0b7c-4b90-bd97-943385d84391"
      ]
    },
    {
      "id": "attack-action--a19ca663-f6ef-4925-bef4-94248349f2e6",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Scheduled Task",
      "tactic_id": "TA0003",
      "tactic_ref": "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
      "technique_id": "T1053.005",
      "technique_ref": "attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9",
      "description": "Scheduled tasks are created that load malicious PowerShell payloads using DLL hijacking with a Google Update binary",
      "effect_refs": [
        "attack-operator--c75d6f51-0b7c-4b90-bd97-943385d84391"
      ]
    },
    {
      "id": "attack-action--ac381463-471d-4ccb-9177-ebd834ed5706",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Windows Service",
      "tactic_id": "TA0003",
      "tactic_ref": "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
      "technique_id": "T1543.003",
      "technique_ref": "attack-pattern--2959d63f-73fd-46a1-abd2-109d7dcede32",
      "description": "Windows services were created and/or modified to load PowerShell scripts",
      "effect_refs": [
        "attack-operator--c75d6f51-0b7c-4b90-bd97-943385d84391"
      ]
    },
    {
      "id": "attack-action--a229d676-e14f-46ee-9bc4-22e769c9abad",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Office Application Startup",
      "tactic_id": "TA0003",
      "tactic_ref": "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
      "technique_id": "T1137",
      "technique_ref": "attack-pattern--2c4d4e92-0ccf-4a97-b54c-86d662988a53",
      "description": "Malicious Outlook backdoor macros were to used to communicate with C2 servers and exfiltrate data",
      "effect_refs": [
        "attack-operator--c75d6f51-0b7c-4b90-bd97-943385d84391"
      ]
    },
    {
      "id": "attack-operator--8e2a58eb-6a0c-486b-b318-8527f5c3357a",
      "type": "attack-operator",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "operator": "AND",
      "effect_refs": [
        "attack-action--ac381463-471d-4ccb-9177-ebd834ed5706",
        "attack-action--8589d97f-43fd-4d11-83a0-41e5902cfe9f",
        "attack-action--3488c178-ef07-4ba9-9007-6ca8aaff51c9",
        "attack-action--a19ca663-f6ef-4925-bef4-94248349f2e6",
        "attack-action--a229d676-e14f-46ee-9bc4-22e769c9abad"
      ]
    },
    {
      "id": "attack-action--96bb23ee-9fa2-4442-b49c-4b2dcc49d043",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "PowerShell",
      "tactic_id": "TA0002",
      "tactic_ref": "x-mitre-tactic--4ca45d45-df4d-4613-8980-bac22d278fa5",
      "technique_id": "T1059.001",
      "technique_ref": "attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736",
      "description": "Obfuscated PowerShell scripts that executes a Cobalt Strike beacon",
      "effect_refs": [
        "attack-operator--8e2a58eb-6a0c-486b-b318-8527f5c3357a"
      ]
    },
    {
      "id": "attack-action--788fab85-7ed0-42d7-aed2-cec8ac099f32",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Visual Basic",
      "tactic_id": "TA0002",
      "tactic_ref": "x-mitre-tactic--4ca45d45-df4d-4613-8980-bac22d278fa5",
      "technique_id": "T1059.005",
      "technique_ref": "attack-pattern--dfd7cc1d-e1d8-4394-a198-97c4cab8aa67",
      "description": "Attackers dropped Visual Basic and PowerShell scripts in folders that they created under the ProgramData",
      "effect_refs": [
        "attack-operator--8e2a58eb-6a0c-486b-b318-8527f5c3357a"
      ]
    },
    {
      "id": "attack-action--398ab58e-b755-4251-9dc5-293817d349ea",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Deobfuscate/Decode Files or Information",
      "tactic_id": "TA0005",
      "tactic_ref": "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
      "technique_id": "T1140",
      "technique_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c",
      "description": "Obfuscated and XOR'ed PowerShell is decoded to download additional obfuscated PowerShell payloads",
      "effect_refs": [
        "attack-action--96bb23ee-9fa2-4442-b49c-4b2dcc49d043",
        "attack-action--788fab85-7ed0-42d7-aed2-cec8ac099f32"
      ]
    },
    {
      "id": "attack-operator--5c3ac180-7cb9-42a6-98de-66e906effc2b",
      "type": "attack-operator",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "operator": "OR",
      "effect_refs": [
        "attack-action--398ab58e-b755-4251-9dc5-293817d349ea"
      ]
    },
    {
      "id": "attack-action--217d8b41-0faf-415e-be60-1489e39d3ee5",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Scheduled Task",
      "tactic_id": "TA0003",
      "tactic_ref": "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
      "technique_id": "T1053.005",
      "technique_ref": "attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9",
      "description": "Two scheduled tasks are created that download additional payloads",
      "effect_refs": [
        "attack-operator--5c3ac180-7cb9-42a6-98de-66e906effc2b"
      ]
    },
    {
      "id": "attack-action--d3d7d621-23f1-4536-8777-aa37cfa4789f",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "PowerShell",
      "tactic_id": "TA0002",
      "tactic_ref": "x-mitre-tactic--4ca45d45-df4d-4613-8980-bac22d278fa5",
      "technique_id": "T1059.001",
      "technique_ref": "attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736",
      "description": "Obfuscated PowerShell scripts delivering Cobalt Strike beacons are downloaded",
      "effect_refs": [
        "attack-operator--5c3ac180-7cb9-42a6-98de-66e906effc2b"
      ]
    },
    {
      "id": "attack-action--508bc600-bbf4-4e31-a789-8971f51dc581",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Spearphishing Attachment",
      "tactic_id": "TA0001",
      "tactic_ref": "x-mitre-tactic--ffd5bcee-6e16-4dd2-8eca-7b3beedf33ca",
      "technique_id": "T1566.001",
      "technique_ref": "attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597",
      "description": "Word documents with malicious macros downloading Cobalt Strike payloads",
      "effect_refs": [
        "attack-action--217d8b41-0faf-415e-be60-1489e39d3ee5"
      ]
    },
    {
      "id": "attack-action--7e43c3eb-f609-4a53-beb3-40829afb89aa",
      "type": "attack-action",
      "spec_version": "2.1",
      "created": "2025-07-30T19:47:12.727Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "name": "Spearphishing Link",
      "tactic_id": "TA0001",
      "tactic_ref": "x-mitre-tactic--ffd5bcee-6e16-4dd2-8eca-7b3beedf33ca",
      "technique_id": "T1566.002",
      "technique_ref": "attack-pattern--2b742742-28c3-4e1b-bab7-8350d6300fa7",
      "description": "Link to a malicious site that downloads a fake Flash Installer delivering Cobalt Strike beacon.",
      "effect_refs": [
        "attack-action--d3d7d621-23f1-4536-8777-aa37cfa4789f"
      ]
    },
    {
      "id": "attack-flow--cc1b4136-b914-402e-ba05-bb16768d4a13",
      "type": "attack-flow",
      "spec_version": "2.1",
      "created": "2022-10-27T02:44:54.520Z",
      "modified": "2025-07-30T19:47:12.727Z",
      "extensions": {
        "extension-definition--fb9c968a-745b-4ade-9b25-c324172197f4": {
          "extension_type": "new-sdo"
        }
      },
      "created_by_ref": "identity--f02f372c-5f8f-49a0-be8e-778cc6f53cc8",
      "start_refs": [
        "attack-action--7e43c3eb-f609-4a53-beb3-40829afb89aa",
        "attack-action--508bc600-bbf4-4e31-a789-8971f51dc581"
      ],
      "name": "Cobalt Kitty Campaign",
      "description": "Cobalt Kitty campaign conducted by OceanLotus.",
      "scope": "campaign",
      "external_references": [
        {
          "source_name": "Cybereason",
          "description": "Article",
          "url": "https://www.cybereason.com/blog/operation-cobalt-kitty-apt"
        },
        {
          "source_name": "CrowdStrike",
          "description": "Adversary Focus",
          "url": "https://adversary.crowdstrike.com/en-US/adversary/ocean-buffalo/"
        },
        {
          "source_name": "MITRE",
          "description": "ATT&CK Group",
          "url": "https://attack.mitre.org/groups/G0050/"
        }
      ]
    }
  ]
}