[
    {
        "type": "marking-definition",
        "spec_version": "2.1",
        "id": "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3",
        "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
        "created": "2020-01-01T00:00:00.000Z",
        "definition_type": "statement",
        "definition": {
            "statement": "Copyright (c) 2020-2023, The MITRE Corporation. All rights reserved."
        }
    },
    {
        "type": "identity",
        "spec_version": "2.1",
        "id": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
        "created": "2020-01-01T00:00:00.000Z",
        "modified": "2020-01-01T00:00:00.000Z",
        "name": "The MITRE Corporation",
        "identity_class": "organization"
    },
    {
        "definition": {
            "statement": "Copyright 2015-2025, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation."
        },
        "id": "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168",
        "type": "marking-definition",
        "created": "2017-06-01T00:00:00.000Z",
        "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
        "definition_type": "statement"
    },
    {
        "modified": "2025-03-19T15:00:40.855Z",
        "name": "The MITRE Corporation",
        "description": "",
        "identity_class": "organization",
        "type": "identity",
        "id": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
        "created": "2017-06-01T00:00:00.000Z",
        "x_mitre_attack_spec_version": "3.3.0"
    },
    {
        "type": "identity",
        "spec_version": "2.1",
        "id": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
        "created": "2020-01-01T00:00:00.000Z",
        "modified": "2020-01-01T00:00:00.000Z",
        "name": "The MITRE Corporation",
        "identity_class": "organization"
    },
    {
        "type": "marking-definition",
        "spec_version": "2.1",
        "id": "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3",
        "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
        "created": "2020-01-01T00:00:00.000Z",
        "definition_type": "statement",
        "definition": {
            "statement": "Copyright (c) 2020-2023, The MITRE Corporation. All rights reserved."
        }
    },
    {
        "type": "malware-method",
        "spec_version": "2.1",
        "id": "malware-method--5650472c-6f90-44c3-8944-f763507e9220",
        "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
        "created": "2023-02-01T10:49:59Z",
        "modified": "2023-02-01T10:49:59Z",
        "name": "Product Key/ID Testing",
        "obj_defn": {
            "source_name": "mbc",
            "external_id": "B0007.005",
            "description": "Checking for a particular product key/ID associated..."
        },
        "behavior_ref": "malware-behavior--7fd7253f-274e-4156-be58-7ac900fc221a",
        "extensions": {
            "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                "extension_type": "new-sdo"
            }
        }
    },
    {
        "type": "malware-objective",
        "spec_version": "2.1",
        "id": "malware-objective--a6de0a96-50b6-441f-8e62-06eb6db84183",
        "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
        "created": "2019-08-01T00:00:00.000Z",
        "modified": "2022-10-31T00:00:00.000Z",
        "name": "Anti-Behavioral Analysis",
        "obj_defn": {
            "source_name": "mbc",
            "description": "Behaviors that prevent, obstruct, or evade <snip>",
            "url": "https://github.com/MBCProject/mbc-markdown <snip> /anti-behavioral-analysis",
            "external_id": "OB0001"
        },
        "external_references": [
            {
                "source_name": "unprotect",
                "url": "https://unprotect.it",
                "description": "T. Roccia and J. Lesueur, Unprotect Project, Accessed Apr. 29, 2023. [Online]."
            },
            {
                "source_name": "poz",
                "url": "https://github.com/knowmalware/InDepthUnpacking",
                "description": "F. Poz, \"InDepthUnpacking,\" 2016. Accessed Apr. 29, 2023. [Online]."
            }
        ],
        "extensions": {
            "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                "extension_type": "new-sdo"
            }
        }
    },
    {
        "type": "attack-pattern",
        "spec_version": "2.1",
        "id": "attack-pattern--29be378d-262d-4e99-b00d-852d573628e6",
        "created": "2020-03-06T20:57:37.959Z",
        "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
        "revoked": false,
        "external_references": [
            {
                "source_name": "mitre-attack",
                "url": "https://attack.mitre.org/techniques/T1497/001",
                "external_id": "T1497.001"
            },
            {
                "source_name": "Unit 42 OilRig Sept 2018",
                "description": "Falcone, R., et al. (2018, September 04). OilRig Targets a Middle Eastern Government and Adds Evasion Techniques to OopsIE. Retrieved September 24, 2018.",
                "url": "https://researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/"
            },
            {
                "source_name": "McAfee Virtual Jan 2017",
                "description": "Roccia, T. (2017, January 19). Stopping Malware With a Fake Virtual Machine. Retrieved April 17, 2019.",
                "url": "https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/stopping-malware-fake-virtual-machine/"
            },
            {
                "source_name": "Deloitte Environment Awareness",
                "description": "Torello, A. & Guibernau, F. (n.d.). Environment Awareness. Retrieved September 13, 2024.",
                "url": "https://drive.google.com/file/d/1t0jn3xr4ff2fR30oQAUn_RsWSnMpOAQc/edit"
            }
        ],
        "object_marking_refs": [
            "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
        ],
        "modified": "2025-04-15T19:58:16.253Z",
        "name": "System Checks",
        "description": "Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)\n\nSpecific checks will vary based on the target and/or adversary, but may involve behaviors such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047), [PowerShell](https://attack.mitre.org/techniques/T1059/001), [System Information Discovery](https://attack.mitre.org/techniques/T1082), and [Query Registry](https://attack.mitre.org/techniques/T1012) to obtain system information and search for VME artifacts. Adversaries may search for VME artifacts in memory, processes, file system, hardware, and/or the Registry. Adversaries may use scripting to automate these checks  into one script and then have the program exit if it determines the system to be a virtual environment. \n\nChecks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. Once executed, malware may also use [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) to check if it was saved in a folder or file with unexpected or even analysis-related naming artifacts such as `malware`, `sample`, or `hash`.\n\nOther common checks may enumerate services running that are unique to these applications, installed programs on the system, manufacturer/product fields for strings relating to virtual machine applications, and VME-specific hardware/processor instructions.(Citation: McAfee Virtual Jan 2017) In applications like VMWare, adversaries can also use a special I/O port to send commands and receive output. \n \nHardware checks, such as the presence of the fan, temperature, and audio devices, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices.(Citation: Unit 42 OilRig Sept 2018)",
        "kill_chain_phases": [
            {
                "kill_chain_name": "mitre-attack",
                "phase_name": "defense-evasion"
            },
            {
                "kill_chain_name": "mitre-attack",
                "phase_name": "discovery"
            }
        ],
        "x_mitre_attack_spec_version": "3.2.0",
        "x_mitre_contributors": [
            "Deloitte Threat Library Team",
            "Kostya Vasilkov"
        ],
        "x_mitre_deprecated": false,
        "x_mitre_detection": "Virtualization/sandbox related system checks will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to virtualization and sandbox identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection.",
        "x_mitre_domains": [
            "enterprise-attack"
        ],
        "x_mitre_is_subtechnique": true,
        "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
        "x_mitre_platforms": [
            "Linux",
            "macOS",
            "Windows"
        ],
        "x_mitre_version": "2.3",
        "x_mitre_data_sources": [
            "Process: Process Creation",
            "Command: Command Execution",
            "Process: OS API Execution"
        ]
    },
    {
        "type": "attack-pattern",
        "spec_version": "2.1",
        "id": "attack-pattern--6ffad4be-bfe0-424f-abde-4d9a84a800ad",
        "created": "2022-03-30T17:53:35.582Z",
        "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
        "revoked": false,
        "external_references": [
            {
                "source_name": "mitre-attack",
                "url": "https://attack.mitre.org/techniques/T1633/001",
                "external_id": "T1633.001"
            }
        ],
        "object_marking_refs": [
            "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
        ],
        "modified": "2025-04-16T21:21:50.837Z",
        "name": "System Checks",
        "description": "Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behavior after checking for the presence of artifacts indicative of a virtual environment or sandbox. If the adversary detects a virtual environment, they may alter their malware’s behavior to disengage from the victim or conceal the core functions of the implant. They may also search for virtualization artifacts before dropping secondary or additional payloads. \n\nChecks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. \n\nHardware checks, such as the presence of motion sensors, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices. ",
        "kill_chain_phases": [
            {
                "kill_chain_name": "mitre-mobile-attack",
                "phase_name": "defense-evasion"
            }
        ],
        "x_mitre_attack_spec_version": "3.2.0",
        "x_mitre_deprecated": false,
        "x_mitre_detection": "Application vetting services could look for applications attempting to get `android.os.SystemProperties` or `getprop` with the runtime `exec()` commands. This could indicate some level of sandbox evasion, as Google recommends against using system properties within applications.",
        "x_mitre_domains": [
            "mobile-attack"
        ],
        "x_mitre_is_subtechnique": true,
        "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
        "x_mitre_platforms": [
            "Android",
            "iOS"
        ],
        "x_mitre_version": "1.1",
        "x_mitre_tactic_type": [
            "Post-Adversary Device Access"
        ]
    },
    {
        "type": "attack-pattern",
        "spec_version": "2.1",
        "id": "attack-pattern--91541e7e-b969-40c6-bbd8-1b5352ec2938",
        "created": "2020-03-06T21:04:12.454Z",
        "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
        "revoked": false,
        "external_references": [
            {
                "source_name": "mitre-attack",
                "url": "https://attack.mitre.org/techniques/T1497/002",
                "external_id": "T1497.002"
            },
            {
                "source_name": "FireEye FIN7 April 2017",
                "description": "Carr, N., et al. (2017, April 24). FIN7 Evolution and the Phishing LNK. Retrieved April 24, 2017.",
                "url": "https://www.fireeye.com/blog/threat-research/2017/04/fin7-phishing-lnk.html"
            },
            {
                "source_name": "Unit 42 Sofacy Nov 2018",
                "description": "Falcone, R., Lee, B.. (2018, November 20). Sofacy Continues Global Attacks and Wheels Out New ‘Cannon’ Trojan. Retrieved April 23, 2019.",
                "url": "https://unit42.paloaltonetworks.com/unit42-sofacy-continues-global-attacks-wheels-new-cannon-trojan/"
            },
            {
                "source_name": "Sans Virtual Jan 2016",
                "description": "Keragala, D. (2016, January 16). Detecting Malware and Sandbox Evasion Techniques. Retrieved April 17, 2019.",
                "url": "https://www.sans.org/reading-room/whitepapers/forensics/detecting-malware-sandbox-evasion-techniques-36667"
            },
            {
                "source_name": "Deloitte Environment Awareness",
                "description": "Torello, A. & Guibernau, F. (n.d.). Environment Awareness. Retrieved September 13, 2024.",
                "url": "https://drive.google.com/file/d/1t0jn3xr4ff2fR30oQAUn_RsWSnMpOAQc/edit"
            }
        ],
        "object_marking_refs": [
            "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
        ],
        "modified": "2025-04-15T19:58:51.123Z",
        "name": "User Activity Based Checks",
        "description": "Adversaries may employ various user activity checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)\n\nAdversaries may search for user activity on the host based on variables such as the speed/frequency of mouse movements and clicks (Citation: Sans Virtual Jan 2016) , browser history, cache, bookmarks, or number of files in common directories such as home or the desktop. Other methods may rely on specific user interaction with the system before the malicious code is activated, such as waiting for a document to close before activating a macro (Citation: Unit 42 Sofacy Nov 2018) or waiting for a user to double click on an embedded image to activate.(Citation: FireEye FIN7 April 2017) ",
        "kill_chain_phases": [
            {
                "kill_chain_name": "mitre-attack",
                "phase_name": "defense-evasion"
            },
            {
                "kill_chain_name": "mitre-attack",
                "phase_name": "discovery"
            }
        ],
        "x_mitre_attack_spec_version": "3.2.0",
        "x_mitre_contributors": [
            "Deloitte Threat Library Team"
        ],
        "x_mitre_deprecated": false,
        "x_mitre_detection": "User activity-based checks will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to virtualization and sandbox identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection. ",
        "x_mitre_domains": [
            "enterprise-attack"
        ],
        "x_mitre_is_subtechnique": true,
        "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
        "x_mitre_platforms": [
            "Linux",
            "macOS",
            "Windows"
        ],
        "x_mitre_version": "1.2",
        "x_mitre_data_sources": [
            "Process: OS API Execution",
            "Process: Process Creation",
            "Command: Command Execution"
        ]
    },
    {
        "type": "malware-behavior",
        "spec_version": "2.1",
        "id": "malware-behavior--7fd7253f-274e-4156-be58-7ac900fc221a",
        "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
        "created": "2019-08-01T00:00:00.000Z",
        "modified": "2022-11-21T00:00:00.000Z",
        "name": "Sandbox Detection",
        "obj_defn": {
            "source_name": "mbc",
            "description": "Detects whether the malware instance is being executed <snip>",
            "url": "https://github.com/MBCProject/mbc-markdown <snip> /sandbox-detection.md",
            "external_id": "B0007"
        },
        "obj_version": "2.0",
        "related_object_refs": [
            "attack-pattern--29be378d-262d-4e99-b00d-852d573628e6",
            "attack-pattern--6ffad4be-bfe0-424f-abde-4d9a84a800ad",
            "attack-pattern--91541e7e-b969-40c6-bbd8-1b5352ec2938"
        ],
        "tags": {
            "Anti-Analysis-Type": "Detection"
        },
        "objective_refs": [
            "malware-objective--a6de0a96-50b6-441f-8e62-06eb6db84183"
        ],
        "detection_rules": [
            {
                "rule_type": "capa",
                "rule_name": "check for sandbox and av modules",
                "url": "https://github.com/capa-rules...check-for-sandbox-and-av-modules.yml",
                "api_fncs": [
                    "GetModuleHandle"
                ],
                "detect_ref": "malware-method--5650472c-6f90-44c3-8944-f763507e9220"
            }
        ],
        "snippets": [
            {
                "snippet": "push ebx, \n add esp, \n 0FFFFFEF4h, \n xor ebx, \n ebx <snip>",
                "language": "asm",
                "exemplify_ref": "malware-method--5650472c-6f90-44c3-8944-f763507e9220"
            }
        ],
        "external_references": [
            {
                "source_name": "cisco",
                "url": "https://blogs.cisco.com/security/talos/rombertik",
                "description": "B. Baker and A. Chiu, \"Threat Spotlight: Rombertik - Gazing Past the Smoke, Mirrors, and Trapdoors,\" Cisco Threat Research, blog, May 4, 2013 [Online]."
            },
            {
                "source_name": "lordnoteworthy",
                "url": "https://github.com/LordNoteworthy/al-khaser",
                "description": "A. Faouzi (LordNoteworthy), \"README.md,\" Al-Khaser v0.81. Accessed Apr. 29, 2023 [Online]."
            }
        ],
        "extensions": {
            "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                "extension_type": "new-sdo"
            }
        }
    }
]