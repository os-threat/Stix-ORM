16:28:21,56 __main__ INFO 
===================================================
16:28:21,56 __main__ INFO Exercising test components with data from mbc/examples
16:28:26,155 stixorm.module.initialise INFO ========================== Database initialisation ============================
16:28:26,174 stixorm.module.initialise INFO Loading TQL objects
16:28:26,174 stixorm.module.initialise INFO 

 insert $mark isa tlp-white, has stix-type "marking-definition", has stix-id "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", has spec-version "2.1", has created 2017-01-20T00:00:00.000;


16:28:26,175 stixorm.module.initialise INFO insert_iterator response ->
<map object at 0x0000020B0958A2F0>
16:28:26,570 stixorm.module.initialise INFO typedb response ->
ConceptMap { map: {"_1": Attribute(Attribute { iid: ID[0x836f80e72800386d61726b696e672d646566696e6974696f6e2d2d36313366326532362d343037642d343863372d396563612d623865393164663939646339], type_: AttributeType { label: "stix-id", is_root: false, is_abstract: false, value_type: String }, value: String("marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"), is_inferred: false }), "_0": Attribute(Attribute { iid: ID[0x836f80db2800126d61726b696e672d646566696e6974696f6e], type_: AttributeType { label: "stix-type", is_root: false, is_abstract: false, value_type: String }, value: String("marking-definition"), is_inferred: false }), "mark": Entity(Entity { iid: ID[0x826e80487fffffffffffffff], type_: EntityType { label: "tlp-white", is_root: false, is_abstract: false }, is_inferred: false }), "_2": Attribute(Attribute { iid: ID[0x836f803d280003322e31], type_: AttributeType { label: "spec-version", is_root: false, is_abstract: false, value_type: String }, value: String("2.1"), is_inferred: false }), "_3": Attribute(Attribute { iid: ID[0x836f80303280000159b92c3800], type_: AttributeType { label: "created", is_root: false, is_abstract: false, value_type: DateTime }, value: DateTime(2017-01-20T00:00:00), is_inferred: false })}, explainables: Explainables { relations: {}, attributes: {}, ownerships: {} } }
16:28:26,570 stixorm.module.initialise INFO 

 insert $mark isa tlp-green, has stix-type "marking-definition", has stix-id "marking-definition--34098fce-860f-48ae-8e50-ebd3cc5e41da", has spec-version "2.1", has created 2017-01-20T00:00:00.000;


16:28:26,570 stixorm.module.initialise INFO insert_iterator response ->
<map object at 0x0000020B0958A3B0>
16:28:26,602 stixorm.module.initialise INFO typedb response ->
ConceptMap { map: {"_0": Attribute(Attribute { iid: ID[0x836f80db2800126d61726b696e672d646566696e6974696f6e], type_: AttributeType { label: "stix-type", is_root: false, is_abstract: false, value_type: String }, value: String("marking-definition"), is_inferred: false }), "_3": Attribute(Attribute { iid: ID[0x836f80303280000159b92c3800], type_: AttributeType { label: "created", is_root: false, is_abstract: false, value_type: DateTime }, value: DateTime(2017-01-20T00:00:00), is_inferred: false }), "_1": Attribute(Attribute { iid: ID[0x836f80e72800386d61726b696e672d646566696e6974696f6e2d2d33343039386663652d383630662d343861652d386535302d656264336363356534316461], type_: AttributeType { label: "stix-id", is_root: false, is_abstract: false, value_type: String }, value: String("marking-definition--34098fce-860f-48ae-8e50-ebd3cc5e41da"), is_inferred: false }), "_2": Attribute(Attribute { iid: ID[0x836f803d280003322e31], type_: AttributeType { label: "spec-version", is_root: false, is_abstract: false, value_type: String }, value: String("2.1"), is_inferred: false }), "mark": Entity(Entity { iid: ID[0x826e80037fffffffffffffff], type_: EntityType { label: "tlp-green", is_root: false, is_abstract: false }, is_inferred: false })}, explainables: Explainables { relations: {}, attributes: {}, ownerships: {} } }
16:28:26,603 stixorm.module.initialise INFO 

 insert $mark isa tlp-amber, has stix-type "marking-definition", has stix-id "marking-definition--f88d31f6-486f-44da-b317-01333bde0b82", has spec-version "2.1", has created 2017-01-20T00:00:00.000;


16:28:26,603 stixorm.module.initialise INFO insert_iterator response ->
<map object at 0x0000020B0958A350>
16:28:26,633 stixorm.module.initialise INFO typedb response ->
ConceptMap { map: {"_2": Attribute(Attribute { iid: ID[0x836f803d280003322e31], type_: AttributeType { label: "spec-version", is_root: false, is_abstract: false, value_type: String }, value: String("2.1"), is_inferred: false }), "_1": Attribute(Attribute { iid: ID[0x836f80e72800386d61726b696e672d646566696e6974696f6e2d2d66383864333166362d343836662d343464612d623331372d303133333362646530623832], type_: AttributeType { label: "stix-id", is_root: false, is_abstract: false, value_type: String }, value: String("marking-definition--f88d31f6-486f-44da-b317-01333bde0b82"), is_inferred: false }), "mark": Entity(Entity { iid: ID[0x826e80217fffffffffffffff], type_: EntityType { label: "tlp-amber", is_root: false, is_abstract: false }, is_inferred: false }), "_3": Attribute(Attribute { iid: ID[0x836f80303280000159b92c3800], type_: AttributeType { label: "created", is_root: false, is_abstract: false, value_type: DateTime }, value: DateTime(2017-01-20T00:00:00), is_inferred: false }), "_0": Attribute(Attribute { iid: ID[0x836f80db2800126d61726b696e672d646566696e6974696f6e], type_: AttributeType { label: "stix-type", is_root: false, is_abstract: false, value_type: String }, value: String("marking-definition"), is_inferred: false })}, explainables: Explainables { relations: {}, attributes: {}, ownerships: {} } }
16:28:26,634 stixorm.module.initialise INFO 

 insert $mark isa tlp-red, has stix-type "marking-definition", has stix-id "marking-definition--5e57c739-391a-4eb3-b6be-7d15ca92d5ed", has spec-version "2.1", has created 2017-01-20T00:00:00.000;


16:28:26,634 stixorm.module.initialise INFO insert_iterator response ->
<map object at 0x0000020B0958A2C0>
16:28:26,672 stixorm.module.initialise INFO typedb response ->
ConceptMap { map: {"_3": Attribute(Attribute { iid: ID[0x836f80303280000159b92c3800], type_: AttributeType { label: "created", is_root: false, is_abstract: false, value_type: DateTime }, value: DateTime(2017-01-20T00:00:00), is_inferred: false }), "_2": Attribute(Attribute { iid: ID[0x836f803d280003322e31], type_: AttributeType { label: "spec-version", is_root: false, is_abstract: false, value_type: String }, value: String("2.1"), is_inferred: false }), "_1": Attribute(Attribute { iid: ID[0x836f80e72800386d61726b696e672d646566696e6974696f6e2d2d35653537633733392d333931612d346562332d623662652d376431356361393264356564], type_: AttributeType { label: "stix-id", is_root: false, is_abstract: false, value_type: String }, value: String("marking-definition--5e57c739-391a-4eb3-b6be-7d15ca92d5ed"), is_inferred: false }), "_0": Attribute(Attribute { iid: ID[0x836f80db2800126d61726b696e672d646566696e6974696f6e], type_: AttributeType { label: "stix-type", is_root: false, is_abstract: false, value_type: String }, value: String("marking-definition"), is_inferred: false }), "mark": Entity(Entity { iid: ID[0x826e803e7fffffffffffffff], type_: EntityType { label: "tlp-red", is_root: false, is_abstract: false }, is_inferred: false })}, explainables: Explainables { relations: {}, attributes: {}, ownerships: {} } }
16:28:26,701 stixorm.module.initialise INFO ===============================================================================


16:28:26,701 stixorm.module.typedb INFO we have loaded Stix schema
16:28:31,504 stixorm.module.typedb INFO we have loaded Stix rules
16:28:34,178 stixorm.module.typedb INFO we have loaded ATT&CK schema
16:28:36,557 stixorm.module.typedb INFO we have loaded OS_THREAT schema
16:28:39,586 stixorm.module.typedb INFO we have loaded OCA schema
16:28:41,741 stixorm.module.typedb INFO we have loaded MBC schema
16:28:43,950 stixorm.module.typedb INFO we have loaded ATTACK_FLOW schema
16:28:43,951 __main__ INFO ['aa_malware_mbc_reference.json', 'gamut.json', 'gravity_rat.json', 'malware_analysis.json', 'original', 'reports', 'unprotect.json']
16:28:43,951 __main__ INFO 

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,952 __main__ INFO ==================== aa_malware_mbc_reference.json ===================================
16:28:43,952 __main__ INFO &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,953 __main__ INFO 9999999999999999999999999 Add 10 99999999999999999999999999999999999999999999
16:28:43,954 __main__ INFO 

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,954 __main__ INFO ==================== gamut.json ===================================
16:28:43,954 __main__ INFO &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,957 __main__ INFO 9999999999999999999999999 Add 17 99999999999999999999999999999999999999999999
16:28:43,957 __main__ INFO 

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,957 __main__ INFO ==================== gravity_rat.json ===================================
16:28:43,957 __main__ INFO &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,959 __main__ INFO 9999999999999999999999999 Add 7 99999999999999999999999999999999999999999999
16:28:43,960 __main__ INFO 

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,961 __main__ INFO ==================== malware_analysis.json ===================================
16:28:43,961 __main__ INFO &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,962 __main__ INFO 9999999999999999999999999 Add 6 99999999999999999999999999999999999999999999
16:28:43,963 __main__ INFO 

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,963 __main__ INFO ==================== unprotect.json ===================================
16:28:43,963 __main__ INFO &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
16:28:43,964 __main__ INFO 9999999999999999999999999 Add 2 99999999999999999999999999999999999999999999
16:28:43,965 __main__ INFO 


===========================
ready to import -> 36
16:28:44,298 stixorm.module.typedb INFO 
##########################################################################################################################################################

16:28:44,343 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:44,343 stixorm.module.typedb_lib.queries INFO insert $attack-identity isa attack-identity,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has x-mitre-attack-spec-version $x-mitre-attack-spec-version,
 has identity-class $identity-class;

 $stix-type "identity";
 $spec-version "2.1";
 $stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $created 2017-06-01T00:00:00.0;
 $modified 2025-03-19T15:00:40.855;
 $name "The MITRE Corporation";
 $description "";
 $x-mitre-attack-spec-version "3.2.0";
 $identity-class "organization";


16:28:44,343 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:44,344 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:44,403 stixorm.module.typedb_lib.queries INFO 


16:28:44,432 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:44,432 stixorm.module.typedb_lib.queries INFO insert $identity isa identity,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has identity-class $identity-class;

 $stix-type "identity";
 $spec-version "2.1";
 $stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
 $created 2020-01-01T00:00:00.0;
 $modified 2020-01-01T00:00:00.0;
 $name "The MITRE Corporation";
 $identity-class "organization";


16:28:44,432 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:44,432 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:44,457 stixorm.module.typedb_lib.queries INFO 


16:28:44,478 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:44,478 stixorm.module.typedb_lib.queries INFO insert $malware isa malware,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has is-family $is-family,
 has aliases $aliases0;

 $stix-type "malware";
 $spec-version "2.1";
 $stix-id "malware--47e74de4-bf1d-4210-a087-2becffdaa455";
 $created 2019-08-01T00:00:00.0;
 $modified 2023-03-01T00:00:00.0;
 $name "Gamut";
 $is-family true;
 $aliases0 "bobax";

$external-reference0 isa external-reference,
 has source-name "trustwave",
 has description "R. Mendrez, 'Gamut Spambot Analysis,' Trustwave, blog, Mar. 4, 2014 [Online].",
 has url-link "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/gamut- spambot-analysis/";
$external-reference1 isa external-reference,
 has source-name "capa analysis",
 has description "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
 has url-link "https://github.com/mandiant/capa-rules";

 $external-references (referenced:$malware, referencing:$external-reference0, referencing:$external-reference1) isa external-references;
 $malware-extension isa malware-extension,
 has extension-type $extension-type,
 has year $year,
 has malware-platforms $platforms0;

 $extension-type "property-extension";
 $year "2014";
 $platforms0 "windows";

 $malware-ext0 (malware:$malware, extension:$malware-extension) isa malware-ext;



16:28:44,478 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:44,478 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:44,560 stixorm.module.typedb_lib.queries INFO 


16:28:44,579 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:44,579 stixorm.module.typedb_lib.queries INFO insert $indicator isa indicator,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has indicator-type $indicator_types0,
 has pattern $pattern,
 has pattern-type $pattern-type,
 has pattern-version $pattern-version,
 has valid-from $valid-from;

 $stix-type "indicator";
 $spec-version "2.1";
 $stix-id "indicator--25ad5feb-3716-44b6-9867-8643f5b2aac8";
 $created 2023-03-01T00:00:00.0;
 $modified 2023-03-01T00:00:00.0;
 $name "Gamut hash";
 $description "This is an IoC for Gamut";
 $indicator_types0 "malicious-activity";
 $pattern "[ file:hashes.'SHA-256' = 'eb51501a7265afec11753ee135a6ef8d0f972eb6af3346f036c5cb8be645d6d4' ]";
 $pattern-type "stix";
 $pattern-version "2.1";
 $valid-from 2023-03-01T00:00:00.0;


16:28:44,579 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:44,580 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:44,615 stixorm.module.typedb_lib.queries INFO 


16:28:44,631 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:44,631 stixorm.module.typedb_lib.queries INFO insert $malware isa malware,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has is-family $is-family;

 $stix-type "malware";
 $spec-version "2.1";
 $stix-id "malware--ccdec6fb-3f9e-4bb6-922b-e16d37ee1ebf";
 $created 2019-08-01T00:00:00.0;
 $modified 2023-03-01T00:00:00.0;
 $name "GravityRAT";
 $is-family true;

$external-reference0 isa external-reference,
 has source-name "capa analysis",
 has description "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
 has url-link "https://github.com/mandiant/capa-rules";

 $external-references (referenced:$malware, referencing:$external-reference0) isa external-references;
 $malware-extension isa malware-extension,
 has extension-type $extension-type,
 has year $year,
 has malware-platforms $platforms0;

 $extension-type "property-extension";
 $year "2018";
 $platforms0 "windows";

 $malware-ext0 (malware:$malware, extension:$malware-extension) isa malware-ext;



16:28:44,631 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:44,631 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:44,677 stixorm.module.typedb_lib.queries INFO 


16:28:44,693 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:44,693 stixorm.module.typedb_lib.queries INFO insert $file isa file,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has size $size,
 has name $name;

 $stix-type "file";
 $spec-version "2.1";
 $stix-id "file--cd46f4ec-ae7e-4e49-babe-8fce238fa4da";
 $size 65536;
 $name "sample.exe";

 $hash0 isa md-5, has hash-value "ffd05678341dcfed98bf019fbbe3409c";
 $hash1 isa sha-1, has hash-value "6634de093251ff6cf441770d1b9b1253556c8d18";
 $hash2 isa sha-256, has hash-value "bddff46c7300e87a7301266cf41ce397e3f0adf6bd9c7e227b56452437769999";

 $hash_rel (hash-owner:$file, hash-actual:$hash0, hash-actual:$hash1, hash-actual:$hash2) isa hashes;

16:28:44,693 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:44,694 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:44,719 stixorm.module.typedb_lib.queries INFO 


16:28:44,740 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:44,743 stixorm.module.typedb_lib.queries INFO insert $malware-objective isa malware-objective,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro;

 $stix-type "malware-objective";
 $spec-version "2.1";
 $stix-id "malware-objective--a624a7aa-ef64-46ce-b582-b963b7d6113f";
 $created 2023-04-21T00:00:00.0;
 $modified 2023-04-21T00:00:00.0;
 $name "Anti-Debugging";
 $micro false;

 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-objective, extension:$mbc-extension) isa mbc-ext;


16:28:44,744 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:44,744 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:44,781 stixorm.module.typedb_lib.queries INFO 


16:28:44,799 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:44,799 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
insert $marking-definition isa marking-definition,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created;

 $stix-type "marking-definition";
 $spec-version "2.1";
 $stix-id "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168";
 $created 2017-06-01T00:00:00.0;


 $created-by0 (created:$marking-definition, creator:$created-by-ref-identity0) isa created-by;

16:28:44,800 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:44,800 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:45,29 stixorm.module.typedb_lib.queries INFO 


16:28:45,49 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,49 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
insert $marking-definition isa marking-definition,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created;

 $stix-type "marking-definition";
 $spec-version "2.1";
 $stix-id "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3";
 $created 2020-01-01T00:00:00.0;


 $created-by0 (created:$marking-definition, creator:$created-by-ref-identity0) isa created-by;

16:28:45,49 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,49 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:45,90 stixorm.module.typedb_lib.queries INFO 


16:28:45,123 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,123 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
insert $malware-method isa malware-method,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro;

 $stix-type "malware-method";
 $spec-version "2.1";
 $stix-id "malware-method--8780cf44-7dfc-41f9-9955-c7c68292e4e9";
 $created 2023-02-01T10:49:59.0;
 $modified 2023-02-01T10:49:59.0;
 $name "Product Key/ID Testing";
 $micro false;


 $created-by0 (created:$malware-method, creator:$created-by-ref-identity0) isa created-by;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-method, extension:$mbc-extension) isa mbc-ext;


16:28:45,123 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,123 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6A40>
16:28:45,185 stixorm.module.typedb_lib.queries INFO 


16:28:45,202 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,202 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
insert $malware-objective isa malware-objective,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro;

 $stix-type "malware-objective";
 $spec-version "2.1";
 $stix-id "malware-objective--f38b4e5f-7c1b-4c17-9610-a739550ab918";
 $created 2019-08-01T00:00:00.0;
 $modified 2022-10-31T00:00:00.0;
 $name "Anti-Behavioral Analysis";
 $micro false;


 $created-by0 (created:$malware-objective, creator:$created-by-ref-identity0) isa created-by;
$external-reference0 isa external-reference,
 has source-name "unprotect",
 has description "T. Roccia and J. Lesueur, Unprotect Project, Accessed Apr. 29, 2023. [Online].",
 has url-link "https://unprotect.it";
$external-reference1 isa external-reference,
 has source-name "poz",
 has description "F. Poz, 'InDepthUnpacking,' 2016. Accessed Apr. 29, 2023. [Online].",
 has url-link "https://github.com/knowmalware/InDepthUnpacking";

 $external-references (referenced:$malware-objective, referencing:$external-reference0, referencing:$external-reference1) isa external-references;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-objective, extension:$mbc-extension) isa mbc-ext;


16:28:45,202 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,202 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F67A0>
16:28:45,247 stixorm.module.typedb_lib.queries INFO 


16:28:45,265 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,265 stixorm.module.typedb_lib.queries INFO match  $indicator0 isa indicator, has stix-id "indicator--25ad5feb-3716-44b6-9867-8643f5b2aac8";
 $malware1 isa malware, has stix-id "malware--47e74de4-bf1d-4210-a087-2becffdaa455";
insert 
$indicates (indicating:$indicator0, indicated:$malware1) isa indicates,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--150c0f85-161a-49c6-a028-8c79bc046adb";
 $created 2023-03-01T00:00:00.0;
 $modified 2023-03-01T00:00:00.0;
 $relationship-type "indicates";


16:28:45,265 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,265 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F67A0>
16:28:45,356 stixorm.module.typedb_lib.queries INFO 


16:28:45,375 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,375 stixorm.module.typedb_lib.queries INFO match  $sample-refs-file00 isa file, has stix-id "file--cd46f4ec-ae7e-4e49-babe-8fce238fa4da";
insert $malware isa malware,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has malware-types $malware_types0,
 has is-family $is-family;

 $stix-type "malware";
 $spec-version "2.1";
 $stix-id "malware--69ee752f-416b-4850-8839-c8f211b8ab17";
 $created 2023-05-02T00:00:00.0;
 $modified 2023-05-02T00:00:00.0;
 $malware_types0 "unknown";
 $is-family false;


 $malware-sample0 (sample-for:$malware, sco-sample:$sample-refs-file00) isa malware-sample;

16:28:45,375 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,375 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F67A0>
16:28:45,432 stixorm.module.typedb_lib.queries INFO 


16:28:45,451 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,452 stixorm.module.typedb_lib.queries INFO match  $sample-ref-file0 isa file, has stix-id "file--cd46f4ec-ae7e-4e49-babe-8fce238fa4da";
insert $malware-analysis isa malware-analysis,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has product $product,
 has version $version,
 has analysis-started $analysis-started,
 has analysis-ended $analysis-ended,
 has result $result;

 $stix-type "malware-analysis";
 $spec-version "2.1";
 $stix-id "malware-analysis--fbcd0450-8879-48cb-a72b-37d2b039892c";
 $created 2023-05-02T12:12:00.0;
 $modified 2023-05-02T12:12:00.0;
 $product "cuckoo";
 $version "2.0.7";
 $analysis-started 2023-03-09T11:52:55.65;
 $analysis-ended 2023-03-09T11:53:13.82;
 $result "suspicious";


 $malware-analysis-sample0 (sample-for:$malware-analysis, sco-sample:$sample-ref-file0) isa malware-analysis-sample;

16:28:45,452 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,452 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F67A0>
16:28:45,510 stixorm.module.typedb_lib.queries INFO 


16:28:45,529 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,529 stixorm.module.typedb_lib.queries INFO match  $objective-refs-malware-objective01 isa malware-objective, has stix-id "malware-objective--a624a7aa-ef64-46ce-b582-b963b7d6113f";
insert $malware-behavior isa malware-behavior,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro,
 has labels $labels0;

 $stix-type "malware-behavior";
 $spec-version "2.1";
 $stix-id "malware-behavior--b4ab6e5e-82b2-4699-938a-778f840a80fa";
 $created 2019-03-18T00:00:00.0;
 $modified 2023-02-27T00:00:00.0;
 $name "GetTickCount";
 $micro false;
 $labels0 "gettickcount";


 $objective-refs1 (behavior:$malware-behavior, objective:$objective-refs-malware-objective01) isa objective-refs;
$snippet0 isa snippet,
 has actual-snippet "bool IsDebugged(DWORD dwNativeElapsed) 
{ 
 DWORD <snip>",
 has language "c++";

 $snippets (behavior:$malware-behavior, code:$snippet0) isa snippets;
$detection-rule0 isa detection-rule,
 has rule-type "capa",
 has rule "rule: 
 meta: 
 name: check for time delay via GetTickCount <snip>";

 $detection-rules (behavior:$malware-behavior, rule:$detection-rule0) isa detection-rules;
$external-reference0 isa external-reference,
 has source-name "palo alto networks",
 has url-link "https://researchcenter.paloaltonetworks.com/2015/10/ticked-off-upatre- malwares -simple-anti-analysis-trick-to-defeat-sandboxes/";
$external-reference1 isa external-reference,
 has source-name "checkpoint",
 has url-link "https://anti-debug.checkpoint.com/techniques/timing.html#kernel-timing";

 $external-references (referenced:$malware-behavior, referencing:$external-reference0, referencing:$external-reference1) isa external-references;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-behavior, extension:$mbc-extension) isa mbc-ext;


16:28:45,529 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,529 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F67A0>
16:28:45,606 stixorm.module.typedb_lib.queries INFO 


16:28:45,623 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,623 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $x-mitre-modified-by-ref-identity1 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $object-marking-refs-marking-definition04 isa marking-definition, has stix-id "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168";
insert $sub-technique isa sub-technique,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has x-mitre-version $x-mitre-version,
 has x-mitre-contributors $x_mitre_contributors0,
 has x-mitre-contributors $x_mitre_contributors1,
 has x-mitre-domains $x_mitre_domains0,
 has x-mitre-attack-spec-version $x-mitre-attack-spec-version,
 has x-mitre-network-requirements $x-mitre-network-requirements,
 has x-mitre-deprecated $x-mitre-deprecated,
 has x-mitre-detection $x-mitre-detection,
 has x-mitre-platforms $x_mitre_platforms0,
 has x-mitre-platforms $x_mitre_platforms1,
 has x-mitre-platforms $x_mitre_platforms2,
 has x-mitre-data-sources $x_mitre_data_sources0,
 has x-mitre-data-sources $x_mitre_data_sources1,
 has x-mitre-data-sources $x_mitre_data_sources2,
 has x-mitre-is-subtechnique $x-mitre-is-subtechnique,
 has x-mitre-remote-support $x-mitre-remote-support;

 $stix-type "attack-pattern";
 $spec-version "2.1";
 $stix-id "attack-pattern--29be378d-262d-4e99-b00d-852d573628e6";
 $created 2020-03-06T20:57:37.959;
 $modified 2025-04-15T19:58:16.253;
 $name "System Checks";
 $description "Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047), [PowerShell](https://attack.mitre.org/techniques/T1059/001), [System Information Discovery](https://attack.mitre.org/techniques/T1082), and [Query Registry](https://attack.mitre.org/techniques/T1012) to obtain system information and search for VME artifacts. Adversaries may search for VME artifacts in memory, processes, file system, hardware, and/or the Registry. Adversaries may use scripting to automate these checks  into one script and then have the program exit if it determines the system to be a virtual environment. 

Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. Once executed, malware may also use [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) to check if it was saved in a folder or file with unexpected or even analysis-related naming artifacts such as `malware`, `sample`, or `hash`.

Other common checks may enumerate services running that are unique to these applications, installed programs on the system, manufacturer/product fields for strings relating to virtual machine applications, and VME-specific hardware/processor instructions.(Citation: McAfee Virtual Jan 2017) In applications like VMWare, adversaries can also use a special I/O port to send commands and receive output. 
 
Hardware checks, such as the presence of the fan, temperature, and audio devices, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices.(Citation: Unit 42 OilRig Sept 2018)";
 $x-mitre-version "2.3";
 $x_mitre_contributors0 "Deloitte Threat Library Team";
 $x_mitre_contributors1 "Kostya Vasilkov";
 $x_mitre_domains0 "enterprise-attack";
 $x-mitre-attack-spec-version "3.2.0";
 $x-mitre-network-requirements false;
 $x-mitre-deprecated false;
 $x-mitre-detection "Virtualization/sandbox related system checks will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to virtualization and sandbox identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection.";
 $x_mitre_platforms0 "Linux";
 $x_mitre_platforms1 "macOS";
 $x_mitre_platforms2 "Windows";
 $x_mitre_data_sources0 "Process: Process Creation";
 $x_mitre_data_sources1 "Command: Command Execution";
 $x_mitre_data_sources2 "Process: OS API Execution";
 $x-mitre-is-subtechnique true;
 $x-mitre-remote-support false;


 $created-by0 (created:$sub-technique, creator:$created-by-ref-identity0) isa created-by;

 $x-mitre-modified-by-ref1 (modified:$sub-technique, modifier:$x-mitre-modified-by-ref-identity1) isa x-mitre-modified-by-ref;
$kill-chain-phase0 isa kill-chain-phase,
 has kill-chain-name "mitre-attack",
 has phase-name "defense-evasion";
$kill-chain-phase1 isa kill-chain-phase,
 has kill-chain-name "mitre-attack",
 has phase-name "discovery";

 $kill-chain-usage (kill-chain-used:$sub-technique, kill-chain-using:$kill-chain-phase0, kill-chain-using:$kill-chain-phase1) isa kill-chain-usage;
$external-reference0 isa external-reference,
 has source-name "mitre-attack",
 has url-link "https://attack.mitre.org/techniques/T1497/001",
 has external-id "T1497.001";
$external-reference1 isa external-reference,
 has source-name "Unit 42 OilRig Sept 2018",
 has description "Falcone, R., et al. (2018, September 04). OilRig Targets a Middle Eastern Government and Adds Evasion Techniques to OopsIE. Retrieved September 24, 2018.",
 has url-link "https://researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/";
$external-reference2 isa external-reference,
 has source-name "McAfee Virtual Jan 2017",
 has description "Roccia, T. (2017, January 19). Stopping Malware With a Fake Virtual Machine. Retrieved April 17, 2019.",
 has url-link "https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/stopping-malware-fake-virtual-machine/";
$external-reference3 isa external-reference,
 has source-name "Deloitte Environment Awareness",
 has description "Torello, A. & Guibernau, F. (n.d.). Environment Awareness. Retrieved September 13, 2024.",
 has url-link "https://drive.google.com/file/d/1t0jn3xr4ff2fR30oQAUn_RsWSnMpOAQc/edit";

 $external-references (referenced:$sub-technique, referencing:$external-reference0, referencing:$external-reference1, referencing:$external-reference2, referencing:$external-reference3) isa external-references;

 $object-marking4 (marked:$sub-technique, marking:$object-marking-refs-marking-definition04) isa object-marking;

16:28:45,623 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,623 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F67A0>
16:28:45,736 stixorm.module.typedb_lib.queries INFO 


16:28:45,750 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,750 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $x-mitre-modified-by-ref-identity1 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $object-marking-refs-marking-definition04 isa marking-definition, has stix-id "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168";
insert $sub-technique isa sub-technique,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has x-mitre-version $x-mitre-version,
 has x-mitre-domains $x_mitre_domains0,
 has x-mitre-attack-spec-version $x-mitre-attack-spec-version,
 has x-mitre-network-requirements $x-mitre-network-requirements,
 has x-mitre-deprecated $x-mitre-deprecated,
 has x-mitre-detection $x-mitre-detection,
 has x-mitre-platforms $x_mitre_platforms0,
 has x-mitre-platforms $x_mitre_platforms1,
 has x-mitre-is-subtechnique $x-mitre-is-subtechnique,
 has x-mitre-tactic-type $x_mitre_tactic_type0,
 has x-mitre-remote-support $x-mitre-remote-support;

 $stix-type "attack-pattern";
 $spec-version "2.1";
 $stix-id "attack-pattern--6ffad4be-bfe0-424f-abde-4d9a84a800ad";
 $created 2022-03-30T17:53:35.582;
 $modified 2025-04-16T21:21:50.837;
 $name "System Checks";
 $description "Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behavior after checking for the presence of artifacts indicative of a virtual environment or sandbox. If the adversary detects a virtual environment, they may alter their malware’s behavior to disengage from the victim or conceal the core functions of the implant. They may also search for virtualization artifacts before dropping secondary or additional payloads. 

Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. 

Hardware checks, such as the presence of motion sensors, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices. ";
 $x-mitre-version "1.1";
 $x_mitre_domains0 "mobile-attack";
 $x-mitre-attack-spec-version "3.2.0";
 $x-mitre-network-requirements false;
 $x-mitre-deprecated false;
 $x-mitre-detection "Application vetting services could look for applications attempting to get `android.os.SystemProperties` or `getprop` with the runtime `exec()` commands. This could indicate some level of sandbox evasion, as Google recommends against using system properties within applications.";
 $x_mitre_platforms0 "Android";
 $x_mitre_platforms1 "iOS";
 $x-mitre-is-subtechnique true;
 $x_mitre_tactic_type0 "Post-Adversary Device Access";
 $x-mitre-remote-support false;


 $created-by0 (created:$sub-technique, creator:$created-by-ref-identity0) isa created-by;

 $x-mitre-modified-by-ref1 (modified:$sub-technique, modifier:$x-mitre-modified-by-ref-identity1) isa x-mitre-modified-by-ref;
$kill-chain-phase0 isa kill-chain-phase,
 has kill-chain-name "mitre-mobile-attack",
 has phase-name "defense-evasion";

 $kill-chain-usage (kill-chain-used:$sub-technique, kill-chain-using:$kill-chain-phase0) isa kill-chain-usage;
$external-reference0 isa external-reference,
 has source-name "mitre-attack",
 has url-link "https://attack.mitre.org/techniques/T1633/001",
 has external-id "T1633.001";

 $external-references (referenced:$sub-technique, referencing:$external-reference0) isa external-references;

 $object-marking4 (marked:$sub-technique, marking:$object-marking-refs-marking-definition04) isa object-marking;

16:28:45,751 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,751 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6770>
16:28:45,811 stixorm.module.typedb_lib.queries INFO 


16:28:45,827 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,827 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $x-mitre-modified-by-ref-identity1 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $object-marking-refs-marking-definition04 isa marking-definition, has stix-id "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168";
insert $sub-technique isa sub-technique,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has x-mitre-version $x-mitre-version,
 has x-mitre-contributors $x_mitre_contributors0,
 has x-mitre-domains $x_mitre_domains0,
 has x-mitre-attack-spec-version $x-mitre-attack-spec-version,
 has x-mitre-network-requirements $x-mitre-network-requirements,
 has x-mitre-deprecated $x-mitre-deprecated,
 has x-mitre-detection $x-mitre-detection,
 has x-mitre-platforms $x_mitre_platforms0,
 has x-mitre-platforms $x_mitre_platforms1,
 has x-mitre-platforms $x_mitre_platforms2,
 has x-mitre-data-sources $x_mitre_data_sources0,
 has x-mitre-data-sources $x_mitre_data_sources1,
 has x-mitre-data-sources $x_mitre_data_sources2,
 has x-mitre-is-subtechnique $x-mitre-is-subtechnique,
 has x-mitre-remote-support $x-mitre-remote-support;

 $stix-type "attack-pattern";
 $spec-version "2.1";
 $stix-id "attack-pattern--91541e7e-b969-40c6-bbd8-1b5352ec2938";
 $created 2020-03-06T21:04:12.454;
 $modified 2025-04-15T19:58:51.123;
 $name "User Activity Based Checks";
 $description "Adversaries may employ various user activity checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries may search for user activity on the host based on variables such as the speed/frequency of mouse movements and clicks (Citation: Sans Virtual Jan 2016) , browser history, cache, bookmarks, or number of files in common directories such as home or the desktop. Other methods may rely on specific user interaction with the system before the malicious code is activated, such as waiting for a document to close before activating a macro (Citation: Unit 42 Sofacy Nov 2018) or waiting for a user to double click on an embedded image to activate.(Citation: FireEye FIN7 April 2017) ";
 $x-mitre-version "1.2";
 $x_mitre_contributors0 "Deloitte Threat Library Team";
 $x_mitre_domains0 "enterprise-attack";
 $x-mitre-attack-spec-version "3.2.0";
 $x-mitre-network-requirements false;
 $x-mitre-deprecated false;
 $x-mitre-detection "User activity-based checks will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to virtualization and sandbox identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection. ";
 $x_mitre_platforms0 "Linux";
 $x_mitre_platforms1 "macOS";
 $x_mitre_platforms2 "Windows";
 $x_mitre_data_sources0 "Process: OS API Execution";
 $x_mitre_data_sources1 "Process: Process Creation";
 $x_mitre_data_sources2 "Command: Command Execution";
 $x-mitre-is-subtechnique true;
 $x-mitre-remote-support false;


 $created-by0 (created:$sub-technique, creator:$created-by-ref-identity0) isa created-by;

 $x-mitre-modified-by-ref1 (modified:$sub-technique, modifier:$x-mitre-modified-by-ref-identity1) isa x-mitre-modified-by-ref;
$kill-chain-phase0 isa kill-chain-phase,
 has kill-chain-name "mitre-attack",
 has phase-name "defense-evasion";
$kill-chain-phase1 isa kill-chain-phase,
 has kill-chain-name "mitre-attack",
 has phase-name "discovery";

 $kill-chain-usage (kill-chain-used:$sub-technique, kill-chain-using:$kill-chain-phase0, kill-chain-using:$kill-chain-phase1) isa kill-chain-usage;
$external-reference0 isa external-reference,
 has source-name "mitre-attack",
 has url-link "https://attack.mitre.org/techniques/T1497/002",
 has external-id "T1497.002";
$external-reference1 isa external-reference,
 has source-name "FireEye FIN7 April 2017",
 has description "Carr, N., et al. (2017, April 24). FIN7 Evolution and the Phishing LNK. Retrieved April 24, 2017.",
 has url-link "https://www.fireeye.com/blog/threat-research/2017/04/fin7-phishing-lnk.html";
$external-reference2 isa external-reference,
 has source-name "Unit 42 Sofacy Nov 2018",
 has description "Falcone, R., Lee, B.. (2018, November 20). Sofacy Continues Global Attacks and Wheels Out New ‘Cannon’ Trojan. Retrieved April 23, 2019.",
 has url-link "https://unit42.paloaltonetworks.com/unit42-sofacy-continues-global-attacks-wheels-new-cannon-trojan/";
$external-reference3 isa external-reference,
 has source-name "Sans Virtual Jan 2016",
 has description "Keragala, D. (2016, January 16). Detecting Malware and Sandbox Evasion Techniques. Retrieved April 17, 2019.",
 has url-link "https://www.sans.org/reading-room/whitepapers/forensics/detecting-malware-sandbox-evasion-techniques-36667";
$external-reference4 isa external-reference,
 has source-name "Deloitte Environment Awareness",
 has description "Torello, A. & Guibernau, F. (n.d.). Environment Awareness. Retrieved September 13, 2024.",
 has url-link "https://drive.google.com/file/d/1t0jn3xr4ff2fR30oQAUn_RsWSnMpOAQc/edit";

 $external-references (referenced:$sub-technique, referencing:$external-reference0, referencing:$external-reference1, referencing:$external-reference2, referencing:$external-reference3, referencing:$external-reference4) isa external-references;

 $object-marking4 (marked:$sub-technique, marking:$object-marking-refs-marking-definition04) isa object-marking;

16:28:45,827 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,827 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6B30>
16:28:45,872 stixorm.module.typedb_lib.queries INFO 


16:28:45,892 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,892 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $x-mitre-modified-by-ref-identity1 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $object-marking-refs-marking-definition04 isa marking-definition, has stix-id "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168";
insert $sub-technique isa sub-technique,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has x-mitre-version $x-mitre-version,
 has x-mitre-contributors $x_mitre_contributors0,
 has x-mitre-contributors $x_mitre_contributors1,
 has x-mitre-contributors $x_mitre_contributors2,
 has x-mitre-contributors $x_mitre_contributors3,
 has x-mitre-domains $x_mitre_domains0,
 has x-mitre-attack-spec-version $x-mitre-attack-spec-version,
 has x-mitre-network-requirements $x-mitre-network-requirements,
 has revoked $revoked,
 has x-mitre-deprecated $x-mitre-deprecated,
 has x-mitre-detection $x-mitre-detection,
 has x-mitre-platforms $x_mitre_platforms0,
 has x-mitre-platforms $x_mitre_platforms1,
 has x-mitre-platforms $x_mitre_platforms2,
 has x-mitre-platforms $x_mitre_platforms3,
 has x-mitre-platforms $x_mitre_platforms4,
 has x-mitre-is-subtechnique $x-mitre-is-subtechnique,
 has x-mitre-remote-support $x-mitre-remote-support;

 $stix-type "attack-pattern";
 $spec-version "2.1";
 $stix-id "attack-pattern--20138b9d-1aac-4a26-8654-a36b6bbf2bba";
 $created 2018-04-18T17:59:24.739;
 $modified 2025-04-25T15:15:15.281;
 $name "Spearphishing Link";
 $description "Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. 

All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)";
 $x-mitre-version "1.2";
 $x_mitre_contributors0 "Shailesh Tiwary (Indian Army)";
 $x_mitre_contributors1 "Mark Wee";
 $x_mitre_contributors2 "Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services)";
 $x_mitre_contributors3 "Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)";
 $x_mitre_domains0 "enterprise-attack";
 $x-mitre-attack-spec-version "3.2.0";
 $x-mitre-network-requirements false;
 $revoked true;
 $x-mitre-deprecated false;
 $x-mitre-detection "URL inspection within email (including expanding shortened links) can help detect links leading to known malicious sites. Detonation chambers can be used to detect these links and either automatically go to these sites to determine if they're potentially malicious, or wait and capture the content if a user visits the link.

Because this technique usually involves user interaction on the endpoint, many of the possible detections for Spearphishing Link take place once [User Execution](https://attack.mitre.org/techniques/T1204) occurs.";
 $x_mitre_platforms0 "Windows";
 $x_mitre_platforms1 "macOS";
 $x_mitre_platforms2 "Linux";
 $x_mitre_platforms3 "Office 365";
 $x_mitre_platforms4 "SaaS";
 $x-mitre-is-subtechnique false;
 $x-mitre-remote-support false;


 $created-by0 (created:$sub-technique, creator:$created-by-ref-identity0) isa created-by;

 $x-mitre-modified-by-ref1 (modified:$sub-technique, modifier:$x-mitre-modified-by-ref-identity1) isa x-mitre-modified-by-ref;
$kill-chain-phase0 isa kill-chain-phase,
 has kill-chain-name "mitre-attack",
 has phase-name "initial-access";

 $kill-chain-usage (kill-chain-used:$sub-technique, kill-chain-using:$kill-chain-phase0) isa kill-chain-usage;
$external-reference0 isa external-reference,
 has source-name "mitre-attack",
 has url-link "https://attack.mitre.org/techniques/T1192",
 has external-id "T1192";
$external-reference1 isa external-reference,
 has source-name "capec",
 has url-link "https://capec.mitre.org/data/definitions/163.html",
 has external-id "CAPEC-163";
$external-reference2 isa external-reference,
 has source-name "Trend Micro Pawn Storm OAuth 2017",
 has description "Hacquebord, F.. (2017, April 25). Pawn Storm Abuses Open Authentication in Advanced Social Engineering Attacks. Retrieved October 4, 2019.",
 has url-link "https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks";

 $external-references (referenced:$sub-technique, referencing:$external-reference0, referencing:$external-reference1, referencing:$external-reference2) isa external-references;

 $object-marking4 (marked:$sub-technique, marking:$object-marking-refs-marking-definition04) isa object-marking;

16:28:45,894 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,894 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6B60>
16:28:45,935 stixorm.module.typedb_lib.queries INFO 


16:28:45,958 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:45,959 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $x-mitre-modified-by-ref-identity1 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $object-marking-refs-marking-definition04 isa marking-definition, has stix-id "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168";
insert $sub-technique isa sub-technique,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has x-mitre-version $x-mitre-version,
 has x-mitre-contributors $x_mitre_contributors0,
 has x-mitre-domains $x_mitre_domains0,
 has x-mitre-attack-spec-version $x-mitre-attack-spec-version,
 has x-mitre-network-requirements $x-mitre-network-requirements,
 has x-mitre-deprecated $x-mitre-deprecated,
 has x-mitre-detection $x-mitre-detection,
 has x-mitre-platforms $x_mitre_platforms0,
 has x-mitre-platforms $x_mitre_platforms1,
 has x-mitre-platforms $x_mitre_platforms2,
 has x-mitre-data-sources $x_mitre_data_sources0,
 has x-mitre-data-sources $x_mitre_data_sources1,
 has x-mitre-is-subtechnique $x-mitre-is-subtechnique,
 has x-mitre-remote-support $x-mitre-remote-support;

 $stix-type "attack-pattern";
 $spec-version "2.1";
 $stix-id "attack-pattern--0a5231ec-41af-4a35-83d0-6bdf11f28c65";
 $created 2017-05-31T21:31:40.542;
 $modified 2025-04-15T19:58:04.668;
 $name "Shared Modules";
 $description "Adversaries may execute malicious payloads via loading shared modules. Shared modules are executable files that are loaded into processes to provide access to reusable code, such as specific custom functions or invoking OS API functions (i.e., [Native API](https://attack.mitre.org/techniques/T1106)).

Adversaries may use this functionality as a way to execute arbitrary payloads on a victim system. For example, adversaries can modularize functionality of their malware into shared objects that perform various functions such as managing C2 network communications or execution of specific actions on objective.

The Linux & macOS module loader can load and execute shared objects from arbitrary local paths. This functionality resides in `dlfcn.h` in functions such as `dlopen` and `dlsym`. Although macOS can execute `.so` files, common practice uses `.dylib` files.(Citation: Apple Dev Dynamic Libraries)(Citation: Linux Shared Libraries)(Citation: RotaJakiro 2021 netlab360 analysis)(Citation: Unit42 OceanLotus 2017)

The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides in `NTDLL.dll` and is part of the Windows [Native API](https://attack.mitre.org/techniques/T1106) which is called from functions like `LoadLibrary` at run time.(Citation: Microsoft DLL)";
 $x-mitre-version "2.3";
 $x_mitre_contributors0 "Stefan Kanthak";
 $x_mitre_domains0 "enterprise-attack";
 $x-mitre-attack-spec-version "3.2.0";
 $x-mitre-network-requirements false;
 $x-mitre-deprecated false;
 $x-mitre-detection "Monitoring DLL module loads may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances, since benign use of Windows modules load functions are common and may be difficult to distinguish from malicious behavior. Legitimate software will likely only need to load routine, bundled DLL modules or Windows system DLLs such that deviation from known module loads may be suspicious. Limiting DLL module loads to `%SystemRoot%` and `%ProgramFiles%` directories will protect against module loads from unsafe paths. 

Correlation of other events with behavior surrounding module loads using API monitoring and suspicious DLLs written to disk will provide additional context to an event that may assist in determining if it is due to malicious behavior.";
 $x_mitre_platforms0 "Windows";
 $x_mitre_platforms1 "macOS";
 $x_mitre_platforms2 "Linux";
 $x_mitre_data_sources0 "Process: OS API Execution";
 $x_mitre_data_sources1 "Module: Module Load";
 $x-mitre-is-subtechnique false;
 $x-mitre-remote-support false;


 $created-by0 (created:$sub-technique, creator:$created-by-ref-identity0) isa created-by;

 $x-mitre-modified-by-ref1 (modified:$sub-technique, modifier:$x-mitre-modified-by-ref-identity1) isa x-mitre-modified-by-ref;
$kill-chain-phase0 isa kill-chain-phase,
 has kill-chain-name "mitre-attack",
 has phase-name "execution";

 $kill-chain-usage (kill-chain-used:$sub-technique, kill-chain-using:$kill-chain-phase0) isa kill-chain-usage;
$external-reference0 isa external-reference,
 has source-name "mitre-attack",
 has url-link "https://attack.mitre.org/techniques/T1129",
 has external-id "T1129";
$external-reference1 isa external-reference,
 has source-name "RotaJakiro 2021 netlab360 analysis",
 has description " Alex Turing, Hui Wang. (2021, April 28). RotaJakiro: A long live secret backdoor with 0 VT detection. Retrieved June 14, 2023.",
 has url-link "https://blog.netlab.360.com/stealth_rotajakiro_backdoor_en/";
$external-reference2 isa external-reference,
 has source-name "Apple Dev Dynamic Libraries",
 has description "Apple. (2012, July 23). Overview of Dynamic Libraries. Retrieved September 7, 2023.",
 has url-link "https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/OverviewOfDynamicLibraries.html";
$external-reference3 isa external-reference,
 has source-name "Unit42 OceanLotus 2017",
 has description "Erye Hernandez and Danny Tsechansky. (2017, June 22). The New and Improved macOS Backdoor from OceanLotus. Retrieved September 8, 2023.",
 has url-link "https://unit42.paloaltonetworks.com/unit42-new-improved-macos-backdoor-oceanlotus/";
$external-reference4 isa external-reference,
 has source-name "Microsoft DLL",
 has description "Microsoft. (2023, April 28). What is a DLL. Retrieved September 7, 2023.",
 has url-link "https://learn.microsoft.com/troubleshoot/windows-client/deployment/dynamic-link-library";
$external-reference5 isa external-reference,
 has source-name "Linux Shared Libraries",
 has description "Wheeler, D. (2003, April 11). Shared Libraries. Retrieved September 7, 2023.",
 has url-link "https://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html";

 $external-references (referenced:$sub-technique, referencing:$external-reference0, referencing:$external-reference1, referencing:$external-reference2, referencing:$external-reference3, referencing:$external-reference4, referencing:$external-reference5) isa external-references;

 $object-marking4 (marked:$sub-technique, marking:$object-marking-refs-marking-definition04) isa object-marking;

16:28:45,959 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:45,959 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6B60>
16:28:46,28 stixorm.module.typedb_lib.queries INFO 


16:28:46,45 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,45 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $x-mitre-modified-by-ref-identity1 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $object-marking-refs-marking-definition04 isa marking-definition, has stix-id "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168";
insert $sub-technique isa sub-technique,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has x-mitre-version $x-mitre-version,
 has x-mitre-contributors $x_mitre_contributors0,
 has x-mitre-contributors $x_mitre_contributors1,
 has x-mitre-contributors $x_mitre_contributors2,
 has x-mitre-domains $x_mitre_domains0,
 has x-mitre-attack-spec-version $x-mitre-attack-spec-version,
 has x-mitre-network-requirements $x-mitre-network-requirements,
 has x-mitre-deprecated $x-mitre-deprecated,
 has x-mitre-detection $x-mitre-detection,
 has x-mitre-platforms $x_mitre_platforms0,
 has x-mitre-platforms $x_mitre_platforms1,
 has x-mitre-platforms $x_mitre_platforms2,
 has x-mitre-platforms $x_mitre_platforms3,
 has x-mitre-platforms $x_mitre_platforms4,
 has x-mitre-platforms $x_mitre_platforms5,
 has x-mitre-platforms $x_mitre_platforms6,
 has x-mitre-platforms $x_mitre_platforms7,
 has x-mitre-data-sources $x_mitre_data_sources0,
 has x-mitre-data-sources $x_mitre_data_sources1,
 has x-mitre-data-sources $x_mitre_data_sources2,
 has x-mitre-is-subtechnique $x-mitre-is-subtechnique,
 has x-mitre-remote-support $x-mitre-remote-support;

 $stix-type "attack-pattern";
 $spec-version "2.1";
 $stix-id "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08";
 $created 2017-05-31T21:31:06.988;
 $modified 2025-04-15T19:58:41.600;
 $name "Account Discovery";
 $description "Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts](https://attack.mitre.org/techniques/T1078)).

Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.

For examples, cloud environments typically provide easily accessible interfaces to obtain user lists.(Citation: AWS List Users)(Citation: Google Cloud - IAM Servie Accounts List API) On hosts, adversaries can use default [PowerShell](https://attack.mitre.org/techniques/T1059/001) and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.";
 $x-mitre-version "2.6";
 $x_mitre_contributors0 "Daniel Stepanic, Elastic";
 $x_mitre_contributors1 "Microsoft Threat Intelligence Center (MSTIC)";
 $x_mitre_contributors2 "Travis Smith, Tripwire";
 $x_mitre_domains0 "enterprise-attack";
 $x-mitre-attack-spec-version "3.2.0";
 $x-mitre-network-requirements false;
 $x-mitre-deprecated false;
 $x-mitre-detection "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.

Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

Monitor for processes that can be used to enumerate user accounts, such as <code>net.exe</code> and <code>net1.exe</code>, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)";
 $x_mitre_platforms0 "Windows";
 $x_mitre_platforms1 "SaaS";
 $x_mitre_platforms2 "IaaS";
 $x_mitre_platforms3 "Linux";
 $x_mitre_platforms4 "macOS";
 $x_mitre_platforms5 "Office Suite";
 $x_mitre_platforms6 "Identity Provider";
 $x_mitre_platforms7 "ESXi";
 $x_mitre_data_sources0 "Process: Process Creation";
 $x_mitre_data_sources1 "Command: Command Execution";
 $x_mitre_data_sources2 "File: File Access";
 $x-mitre-is-subtechnique false;
 $x-mitre-remote-support false;


 $created-by0 (created:$sub-technique, creator:$created-by-ref-identity0) isa created-by;

 $x-mitre-modified-by-ref1 (modified:$sub-technique, modifier:$x-mitre-modified-by-ref-identity1) isa x-mitre-modified-by-ref;
$kill-chain-phase0 isa kill-chain-phase,
 has kill-chain-name "mitre-attack",
 has phase-name "discovery";

 $kill-chain-usage (kill-chain-used:$sub-technique, kill-chain-using:$kill-chain-phase0) isa kill-chain-usage;
$external-reference0 isa external-reference,
 has source-name "mitre-attack",
 has url-link "https://attack.mitre.org/techniques/T1087",
 has external-id "T1087";
$external-reference1 isa external-reference,
 has source-name "AWS List Users",
 has description "Amazon. (n.d.). List Users. Retrieved August 11, 2020.",
 has url-link "https://docs.aws.amazon.com/cli/latest/reference/iam/list-users.html";
$external-reference2 isa external-reference,
 has source-name "Google Cloud - IAM Servie Accounts List API",
 has description "Google. (2020, June 23). gcloud iam service-accounts list. Retrieved August 4, 2020.",
 has url-link "https://cloud.google.com/sdk/gcloud/reference/iam/service-accounts/list";
$external-reference3 isa external-reference,
 has source-name "Elastic - Koadiac Detection with EQL",
 has description "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 17, 2024.",
 has url-link "https://www.elastic.co/security-labs/embracing-offensive-tooling-building-detections-against-koadic-using-eql";

 $external-references (referenced:$sub-technique, referencing:$external-reference0, referencing:$external-reference1, referencing:$external-reference2, referencing:$external-reference3) isa external-references;

 $object-marking4 (marked:$sub-technique, marking:$object-marking-refs-marking-definition04) isa object-marking;

16:28:46,45 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,45 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:46,104 stixorm.module.typedb_lib.queries INFO 


16:28:46,124 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,125 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $x-mitre-modified-by-ref-identity1 isa identity, has stix-id "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5";
 $object-marking-refs-marking-definition03 isa marking-definition, has stix-id "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168";
insert $software-malware isa software-malware,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has description $description,
 has x-mitre-version $x-mitre-version,
 has x-mitre-domains $x_mitre_domains0,
 has x-mitre-attack-spec-version $x-mitre-attack-spec-version,
 has is-family $is-family,
 has x-mitre-deprecated $x-mitre-deprecated,
 has x-mitre-platforms $x_mitre_platforms0,
 has x-mitre-aliases $x_mitre_aliases0;

 $stix-type "malware";
 $spec-version "2.1";
 $stix-id "malware--1d1fce2f-0db5-402b-9843-4278a0694637";
 $created 2018-10-17T00:14:20.652;
 $modified 2024-04-11T02:25:20.119;
 $name "GravityRAT";
 $description "[GravityRAT](https://attack.mitre.org/software/S0237) is a remote access tool (RAT) and has been in ongoing development since 2016. The actor behind the tool remains unknown, but two usernames have been recovered that link to the author, which are 'TheMartian' and 'The Invincible.' According to the National Computer Emergency Response Team (CERT) of India, the malware has been identified in attacks against organization and entities in India. (Citation: Talos GravityRAT)";
 $x-mitre-version "1.3";
 $x_mitre_domains0 "enterprise-attack";
 $x-mitre-attack-spec-version "3.2.0";
 $is-family true;
 $x-mitre-deprecated false;
 $x_mitre_platforms0 "Windows";
 $x_mitre_aliases0 "GravityRAT";


 $created-by0 (created:$software-malware, creator:$created-by-ref-identity0) isa created-by;

 $x-mitre-modified-by-ref1 (modified:$software-malware, modifier:$x-mitre-modified-by-ref-identity1) isa x-mitre-modified-by-ref;
$external-reference0 isa external-reference,
 has source-name "mitre-attack",
 has url-link "https://attack.mitre.org/software/S0237",
 has external-id "S0237";
$external-reference1 isa external-reference,
 has source-name "GravityRAT",
 has description "(Citation: Talos GravityRAT)";
$external-reference2 isa external-reference,
 has source-name "Talos GravityRAT",
 has description "Mercer, W., Rascagneres, P. (2018, April 26). GravityRAT - The Two-Year Evolution Of An APT Targeting India. Retrieved May 16, 2018.",
 has url-link "https://blog.talosintelligence.com/2018/04/gravityrat-two-year-evolution-of-apt.html";

 $external-references (referenced:$software-malware, referencing:$external-reference0, referencing:$external-reference1, referencing:$external-reference2) isa external-references;

 $object-marking3 (marked:$software-malware, marking:$object-marking-refs-marking-definition03) isa object-marking;

16:28:46,125 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,125 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F7100>
16:28:46,212 stixorm.module.typedb_lib.queries INFO 


16:28:46,239 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,239 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
 $object-marking-refs-marking-definition02 isa marking-definition, has stix-id "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3";
insert $malware-objective isa malware-objective,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro;

 $stix-type "malware-objective";
 $spec-version "2.1";
 $stix-id "malware-objective--5823a1fb-61cd-4484-abfc-adfa88cca816";
 $created 2020-08-14T00:00:00.0;
 $modified 2023-05-08T00:00:00.0;
 $name "Communication";
 $micro true;


 $created-by0 (created:$malware-objective, creator:$created-by-ref-identity0) isa created-by;

 $object-marking2 (marked:$malware-objective, marking:$object-marking-refs-marking-definition02) isa object-marking;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-objective, extension:$mbc-extension) isa mbc-ext;


16:28:46,239 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,241 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:46,316 stixorm.module.typedb_lib.queries INFO 


16:28:46,337 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,337 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
 $object-marking-refs-marking-definition02 isa marking-definition, has stix-id "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3";
insert $malware-method isa malware-method,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro;

 $stix-type "malware-method";
 $spec-version "2.1";
 $stix-id "malware-method--40cb93ee-9bab-4239-a0de-0556ad4cd999";
 $created 2020-08-14T00:00:00.0;
 $modified 2024-04-29T00:00:00.0;
 $name "Resolve";
 $micro false;


 $created-by0 (created:$malware-method, creator:$created-by-ref-identity0) isa created-by;

 $object-marking2 (marked:$malware-method, marking:$object-marking-refs-marking-definition02) isa object-marking;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-method, extension:$mbc-extension) isa mbc-ext;


16:28:46,337 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,337 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:46,380 stixorm.module.typedb_lib.queries INFO 


16:28:46,405 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,405 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
 $object-marking-refs-marking-definition02 isa marking-definition, has stix-id "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3";
insert $malware-method isa malware-method,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro;

 $stix-type "malware-method";
 $spec-version "2.1";
 $stix-id "malware-method--8d2f6d63-16d3-4b1e-9a5c-2ea3cede8a96";
 $created 2020-08-14T00:00:00.0;
 $modified 2023-09-13T00:00:00.0;
 $name "Server Connect";
 $micro false;


 $created-by0 (created:$malware-method, creator:$created-by-ref-identity0) isa created-by;

 $object-marking2 (marked:$malware-method, marking:$object-marking-refs-marking-definition02) isa object-marking;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-method, extension:$mbc-extension) isa mbc-ext;


16:28:46,405 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,405 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:46,456 stixorm.module.typedb_lib.queries INFO 


16:28:46,475 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,475 stixorm.module.typedb_lib.queries INFO match  $malware0 isa malware, has stix-id "malware--69ee752f-416b-4850-8839-c8f211b8ab17";
 $malware-method1 isa malware-method, has stix-id "malware-method--8780cf44-7dfc-41f9-9955-c7c68292e4e9";
insert 
$uses (used-by:$malware0, used:$malware-method1) isa uses,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type,
 has description $description;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--c7bfedca-f78a-4909-8d8d-331578e0ed30";
 $created 2020-05-29T01:01:46.370;
 $modified 2020-05-29T01:01:46.370;
 $relationship-type "uses";
 $description "Sandbox Detection::Product Key/ID Testing";


16:28:46,475 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,475 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:46,532 stixorm.module.typedb_lib.queries INFO 


16:28:46,553 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,553 stixorm.module.typedb_lib.queries INFO match  $malware-analysis0 isa malware-analysis, has stix-id "malware-analysis--fbcd0450-8879-48cb-a72b-37d2b039892c";
 $malware1 isa malware, has stix-id "malware--69ee752f-416b-4850-8839-c8f211b8ab17";
insert 
$dynamic-analysis-of (analysing:$malware-analysis0, analysed:$malware1) isa dynamic-analysis,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--a94a69a5-5498-4fc4-b3e4-4338152e3137";
 $created 2020-05-02T12:12:00.0;
 $modified 2020-05-02T12:12:00.0;
 $relationship-type "dynamic-analysis-of";


16:28:46,553 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,553 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:46,594 stixorm.module.typedb_lib.queries INFO 


16:28:46,614 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,614 stixorm.module.typedb_lib.queries INFO match  $malware-method0 isa malware-method, has stix-id "malware-method--8780cf44-7dfc-41f9-9955-c7c68292e4e9";
 $malware-analysis1 isa malware-analysis, has stix-id "malware-analysis--fbcd0450-8879-48cb-a72b-37d2b039892c";
insert 
$derived-from (derived-from:$malware-method0, deriving:$malware-analysis1) isa derived,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--6ca00411-2b6c-4842-9b27-4a23c3bf74db";
 $created 2020-05-29T01:01:46.369;
 $modified 2020-05-29T01:01:46.369;
 $relationship-type "derived-from";


16:28:46,614 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,614 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:46,670 stixorm.module.typedb_lib.queries INFO 


16:28:46,689 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,689 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
 $related-object-refs-attack-pattern02 isa attack-pattern, has stix-id "attack-pattern--29be378d-262d-4e99-b00d-852d573628e6";
 $related-object-refs-attack-pattern12 isa attack-pattern, has stix-id "attack-pattern--6ffad4be-bfe0-424f-abde-4d9a84a800ad";
 $related-object-refs-attack-pattern22 isa attack-pattern, has stix-id "attack-pattern--91541e7e-b969-40c6-bbd8-1b5352ec2938";
 $objective-refs-malware-objective04 isa malware-objective, has stix-id "malware-objective--f38b4e5f-7c1b-4c17-9610-a739550ab918";
 $exemplify-ref-malware-method0 isa malware-method, has stix-id "malware-method--8780cf44-7dfc-41f9-9955-c7c68292e4e9";
 $detect-ref-malware-method0 isa malware-method, has stix-id "malware-method--8780cf44-7dfc-41f9-9955-c7c68292e4e9";
insert $malware-behavior isa malware-behavior,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro,
 has obj-version $obj-version;

 $stix-type "malware-behavior";
 $spec-version "2.1";
 $stix-id "malware-behavior--54b3edd9-186c-4b8e-858e-95318349f658";
 $created 2019-08-01T00:00:00.0;
 $modified 2022-11-21T00:00:00.0;
 $name "Sandbox Detection";
 $micro false;
 $obj-version "2.0";


 $created-by0 (created:$malware-behavior, creator:$created-by-ref-identity0) isa created-by;

 $related-object-refs2 (behavior:$malware-behavior, related-object:$related-object-refs-attack-pattern02, related-object:$related-object-refs-attack-pattern12, related-object:$related-object-refs-attack-pattern22) isa related-object-refs;

 $tag-key0 isa tag-key;  $tag-key0 has dict-key "Anti-Analysis-Type";
 $tag-key0 has tag-value "Detection";
 $tags (behavior:$malware-behavior, tag: $tag-key0) isa tags;


 $objective-refs4 (behavior:$malware-behavior, objective:$objective-refs-malware-objective04) isa objective-refs;
$snippet0 isa snippet,
 has actual-snippet "push ebx, 
 add esp, 
 0FFFFFEF4h, 
 xor ebx, 
 ebx <snip>",
 has language "asm";

 $snippets (behavior:$malware-behavior, code:$snippet0) isa snippets;

 $exemplify-ref0 (example:$snippet0, method:$exemplify-ref-malware-method0) isa exemplify-ref;
$detection-rule0 isa detection-rule,
 has rule-type "capa",
 has rule-name "check for sandbox and av modules",
 has url-string "https://github.com/capa-rules...check-for-sandbox-and-av-modules.yml",
 has api-fncs "GetModuleHandle";

 $detection-rules (behavior:$malware-behavior, rule:$detection-rule0) isa detection-rules;

 $detect-ref0 (rule:$detection-rule0, method:$detect-ref-malware-method0) isa detect-ref;
$external-reference0 isa external-reference,
 has source-name "cisco",
 has description "B. Baker and A. Chiu, 'Threat Spotlight: Rombertik - Gazing Past the Smoke, Mirrors, and Trapdoors,' Cisco Threat Research, blog, May 4, 2013 [Online].",
 has url-link "https://blogs.cisco.com/security/talos/rombertik";
$external-reference1 isa external-reference,
 has source-name "lordnoteworthy",
 has description "A. Faouzi (LordNoteworthy), 'README.md,' Al-Khaser v0.81. Accessed Apr. 29, 2023 [Online].",
 has url-link "https://github.com/LordNoteworthy/al-khaser";

 $external-references (referenced:$malware-behavior, referencing:$external-reference0, referencing:$external-reference1) isa external-references;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-behavior, extension:$mbc-extension) isa mbc-ext;


16:28:46,690 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,690 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:46,953 stixorm.module.typedb_lib.queries INFO 


16:28:46,972 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:46,972 stixorm.module.typedb_lib.queries INFO match  $malware0 isa malware, has stix-id "malware--47e74de4-bf1d-4210-a087-2becffdaa455";
 $attack-pattern1 isa attack-pattern, has stix-id "attack-pattern--0a5231ec-41af-4a35-83d0-6bdf11f28c65";
insert 
$uses (used-by:$malware0, used:$attack-pattern1) isa uses,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type,
 has description $description;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--2faba4f3-9b0a-4ed6-a18b-5eaa23ebc911";
 $created 2023-03-20T00:00:00.0;
 $modified 2023-03-20T00:00:00.0;
 $relationship-type "uses";
 $description "Execution::Shared Modules (T1129) -- Gamut links functions <snip> (Citation: trustwave gamut analysis) <snip>";


16:28:46,972 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:46,972 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:47,30 stixorm.module.typedb_lib.queries INFO 


16:28:47,44 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:47,44 stixorm.module.typedb_lib.queries INFO match  $malware0 isa malware, has stix-id "malware--ccdec6fb-3f9e-4bb6-922b-e16d37ee1ebf";
 $attack-pattern1 isa attack-pattern, has stix-id "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08";
insert 
$uses (used-by:$malware0, used:$attack-pattern1) isa uses,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type,
 has description $description;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--317b8221-af95-4f8c-baea-51085fe1e986";
 $created 2023-05-03T00:00:00.0;
 $modified 2023-05-03T00:00:00.0;
 $relationship-type "uses";
 $description "Discovery::Account Discovery (T1087) -- GravityRAT gets session username (Citation: capa analysis).";


16:28:47,44 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:47,44 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:47,71 stixorm.module.typedb_lib.queries INFO 


16:28:47,93 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:47,93 stixorm.module.typedb_lib.queries INFO match  $malware0 isa malware, has stix-id "malware--ccdec6fb-3f9e-4bb6-922b-e16d37ee1ebf";
 $malware1 isa malware, has stix-id "malware--1d1fce2f-0db5-402b-9843-4278a0694637";
insert 
$related-to (related-from:$malware0, related-to:$malware1) isa related,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--46271d16-fd2c-4cc2-a9ea-89c815606c2a";
 $created 2023-05-03T00:00:00.0;
 $modified 2023-05-03T00:00:00.0;
 $relationship-type "related-to";


16:28:47,93 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:47,93 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:47,151 stixorm.module.typedb_lib.queries INFO 


16:28:47,170 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:47,171 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
 $objective-refs-malware-objective02 isa malware-objective, has stix-id "malware-objective--5823a1fb-61cd-4484-abfc-adfa88cca816";
 $detect-ref-malware-method0 isa malware-method, has stix-id "malware-method--8d2f6d63-16d3-4b1e-9a5c-2ea3cede8a96";
 $detect-ref-malware-method1 isa malware-method, has stix-id "malware-method--40cb93ee-9bab-4239-a0de-0556ad4cd999";
 $object-marking-refs-marking-definition05 isa marking-definition, has stix-id "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3";
insert $malware-behavior isa malware-behavior,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro,
 has obj-version $obj-version;

 $stix-type "malware-behavior";
 $spec-version "2.1";
 $stix-id "malware-behavior--a28f7a00-c512-4a1e-88a9-9eeeca8a162a";
 $created 2020-08-14T00:00:00.0;
 $modified 2024-04-29T00:00:00.0;
 $name "DNS Communication";
 $micro false;
 $obj-version "2.2";


 $created-by0 (created:$malware-behavior, creator:$created-by-ref-identity0) isa created-by;

 $objective-refs2 (behavior:$malware-behavior, objective:$objective-refs-malware-objective02) isa objective-refs;
$detection-rule0 isa detection-rule,
 has rule-type "capa",
 has rule-name "reference DNS over HTTPS endpoints",
 has url-string "https://github.com/mandiant/capa-rules/blob/master/communication/dns/reference-dns-over-https-endpoints.yml";
$detection-rule1 isa detection-rule,
 has rule-type "capa",
 has rule-name "resolve DNS",
 has url-string "https://github.com/mandiant/capa-rules/blob/master/communication/dns/resolve-dns.yml",
 has api-fncs "ws2_32.gethostbyname",
 has api-fncs "DnsQuery_A",
 has api-fncs "DnsQuery_W",
 has api-fncs "DnsQuery_UTF8",
 has api-fncs "DnsQueryEx",
 has api-fncs "GetAddrInfo",
 has api-fncs "GetAddrInfoW",
 has api-fncs "GetAddrInfoEx",
 has api-fncs "gethostbyname",
 has api-fncs "getaddrinfo",
 has api-fncs "getnameinfo",
 has api-fncs "gethostent",
 has api-fncs "System.Net.Dns::GetHostAddresses";
$detection-rule2 isa detection-rule,
 has rule-type "cape",
 has rule-name "network_dns_blockchain",
 has url-string "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/network_dns_suspicious.py",
 has class-name "NetworkDNSBlockChain";
$detection-rule3 isa detection-rule,
 has rule-type "cape",
 has rule-name "network_dns_idn",
 has url-string "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/network_dns_suspicious.py",
 has api-fncs "DnsQueryA";
$detection-rule4 isa detection-rule,
 has rule-type "cape",
 has rule-name "network_dns_opennic",
 has url-string "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/network_dns_suspicious.py";
$detection-rule5 isa detection-rule,
 has rule-type "cape",
 has rule-name "network_dns_reverse_proxy",
 has url-string "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/network_dns_suspicious.py";
$detection-rule6 isa detection-rule,
 has rule-type "cape",
 has rule-name "network_dns_suspicious_querytype",
 has url-string "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/network_dns_suspicious.py",
 has api-fncs "DnsQueryA";
$detection-rule7 isa detection-rule,
 has rule-type "cape",
 has rule-name "network_dns_tunneling_request",
 has url-string "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/network_dns_suspicious.py",
 has api-fncs "DnsQuery_A",
 has api-fncs "DnsQuery_W";
$detection-rule8 isa detection-rule,
 has rule-type "cape",
 has rule-name "network_dns_doh_tls",
 has url-string "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/network_dns_suspicious.py";
$detection-rule9 isa detection-rule,
 has rule-type "cape",
 has rule-name "network_dga",
 has url-string "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/network_dga.py",
 has api-fncs " --";

 $detection-rules (behavior:$malware-behavior, rule:$detection-rule0, rule:$detection-rule1, rule:$detection-rule2, rule:$detection-rule3, rule:$detection-rule4, rule:$detection-rule5, rule:$detection-rule6, rule:$detection-rule7, rule:$detection-rule8, rule:$detection-rule9) isa detection-rules;

 $detect-ref0 (rule:$detection-rule0, method:$detect-ref-malware-method0) isa detect-ref;

 $detect-ref1 (rule:$detection-rule1, method:$detect-ref-malware-method1) isa detect-ref;
$external-reference0 isa external-reference,
 has source-name "capa analysis",
 has description "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
 has url-link "https://github.com/mandiant/capa-rules";

 $external-references (referenced:$malware-behavior, referencing:$external-reference0) isa external-references;

 $object-marking5 (marked:$malware-behavior, marking:$object-marking-refs-marking-definition05) isa object-marking;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-behavior, extension:$mbc-extension) isa mbc-ext;


16:28:47,171 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:47,171 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:47,389 stixorm.module.typedb_lib.queries INFO 


16:28:47,424 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:47,424 stixorm.module.typedb_lib.queries INFO match  $created-by-ref-identity0 isa identity, has stix-id "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf";
 $behavior-ref-malware-behavior2 isa malware-behavior, has stix-id "malware-behavior--a28f7a00-c512-4a1e-88a9-9eeeca8a162a";
 $object-marking-refs-marking-definition03 isa marking-definition, has stix-id "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3";
insert $malware-method isa malware-method,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has name $name,
 has micro $micro;

 $stix-type "malware-method";
 $spec-version "2.1";
 $stix-id "malware-method--b9c9fb8c-71d5-4e9f-9b06-88ba43873c86";
 $created 2020-08-14T00:00:00.0;
 $modified 2024-04-29T00:00:00.0;
 $name "Resolve Free Hosting Domain";
 $micro false;


 $created-by0 (created:$malware-method, creator:$created-by-ref-identity0) isa created-by;

 $behavior-ref2 (method:$malware-method, behavior:$behavior-ref-malware-behavior2) isa behavior-ref;

 $object-marking3 (marked:$malware-method, marking:$object-marking-refs-marking-definition03) isa object-marking;
 $mbc-extension isa mbc-extension,
 has extension-type $extension-type;

 $extension-type "new-sdo";

 $mbc-ext0 (mbc:$malware-method, extension:$mbc-extension) isa mbc-ext;


16:28:47,424 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:47,424 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:47,505 stixorm.module.typedb_lib.queries INFO 


16:28:47,525 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:47,526 stixorm.module.typedb_lib.queries INFO match  $malware0 isa malware, has stix-id "malware--47e74de4-bf1d-4210-a087-2becffdaa455";
 $malware-behavior1 isa malware-behavior, has stix-id "malware-behavior--a28f7a00-c512-4a1e-88a9-9eeeca8a162a";
insert 
$uses (used-by:$malware0, used:$malware-behavior1) isa uses,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type,
 has description $description;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--a9bd4515-4e8a-4c4e-b54b-a612c9da6585";
 $created 2023-03-20T00:00:00.0;
 $modified 2023-03-20T00:00:00.0;
 $relationship-type "uses";
 $description "File System::Delete File (C0047)-- Gamut deletes files. (Citation: capa analysis output)";


16:28:47,526 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:47,526 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:47,594 stixorm.module.typedb_lib.queries INFO 


16:28:47,622 stixorm.module.typedb_lib.queries INFO 
------------------------------------------------ Add Layer Query ----------------------------------------------

16:28:47,622 stixorm.module.typedb_lib.queries INFO match  $malware0 isa malware, has stix-id "malware--47e74de4-bf1d-4210-a087-2becffdaa455";
 $malware-method1 isa malware-method, has stix-id "malware-method--b9c9fb8c-71d5-4e9f-9b06-88ba43873c86";
insert 
$uses (used-by:$malware0, used:$malware-method1) isa uses,
 has stix-type $stix-type,
 has spec-version $spec-version,
 has stix-id $stix-id,
 has created $created,
 has modified $modified,
 has relationship-type $relationship-type,
 has description $description;

 $stix-type "relationship";
 $spec-version "2.1";
 $stix-id "relationship--5e8a2121-6e0d-4d6f-b4c2-0d84928cf39e";
 $created 2023-03-20T00:00:00.0;
 $modified 2023-03-20T00:00:00.0;
 $relationship-type "uses";
 $description "Command and Control::C2 Communication::Receive Data (B0030.002) -- The malware sends data to the C2. (Citation: trustwave gamut analysis)";


16:28:47,623 stixorm.module.typedb_lib.queries INFO 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    Add Layer Response     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

16:28:47,623 stixorm.module.typedb_lib.queries INFO insert_iterator response ->
<map object at 0x0000020B099F6AA0>
16:28:47,656 stixorm.module.typedb_lib.queries INFO 


16:28:47,799 __main__ INFO 


===========================
input len -> 36, typedn len ->36
16:28:47,799 __main__ INFO difference -> 
16:28:47,800 __main__ INFO ===================================================


